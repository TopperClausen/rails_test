  [1m[35m (5.9ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.3ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'development', '2023-11-06 12:11:53.172438', '2023-11-06 12:11:53.172441') RETURNING "key"[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateUsersTable (20231106120630)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "full_name" varchar, "email" varchar, "password_digest" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE UNIQUE INDEX "unique_emails" ON "users" ("email")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20231106120630') RETURNING "version"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateUsersTable (20231106120630)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.7ms)[0m  [1m[35mDROP TABLE "users"[0m
  [1m[36mActiveRecord::SchemaMigration Destroy (0.1ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = '20231106120630'[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateUsersTable (20231106120630)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "full_name" varchar, "email" varchar, "password_digest" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20231106120630') RETURNING "version"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started POST "/users" for ::1 at 2023-11-06 13:30:24 +0100
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by UsersController#create as */*
  Parameters: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "user"=>{"full_name"=>"Super Admin", "email"=>"admin@test.dk"}}
[31mUnpermitted parameter: :user. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x00007fc81eb0e8a0>, params: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "controller"=>"users", "action"=>"create", "user"=>{"full_name"=>"Super Admin", "email"=>"admin@test.dk"}} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/controllers/users_controller.rb:5:in `create'
  [1m[36mUser Create (1.0ms)[0m  [1m[32mINSERT INTO "users" ("full_name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["full_name", "Super Admin"], ["email", "admin@test.dk"], ["password_digest", "[FILTERED]"], ["created_at", "2023-11-06 12:30:25.004037"], ["updated_at", "2023-11-06 12:30:25.004037"]]
  â†³ app/controllers/users_controller.rb:5:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/controllers/users_controller.rb:5:in `create'
Completed 200 OK in 197ms (Views: 0.2ms | ActiveRecord: 1.6ms | Allocations: 15793)


Started GET "/users" for ::1 at 2023-11-06 13:32:12 +0100
Processing by UsersController#index as */*
Completed 500 Internal Server Error in 0ms (ActiveRecord: 0.0ms | Allocations: 161)


  
NameError (undefined local variable or method `user' for #<UsersController:0x0000000000b838>):
  
app/controllers/users_controller.rb:3:in `index'
Started GET "/users" for ::1 at 2023-11-06 13:32:21 +0100
Processing by UsersController#index as */*
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users"[0m
  â†³ app/controllers/users_controller.rb:3:in `index'
Completed 200 OK in 11ms (Views: 2.9ms | ActiveRecord: 1.3ms | Allocations: 7262)


  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateUsersTable (20231106120630)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.7ms)[0m  [1m[35mDROP TABLE "users"[0m
  [1m[36mActiveRecord::SchemaMigration Destroy (0.0ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = '20231106120630'[0m
  [1m[36mTRANSACTION (5.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateUsersTable (20231106120630)
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateUsersTable (20231106120630)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "full_name" varchar, "email" varchar, "password_digest" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_users_on_email" ON "users" ("email")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20231106120630') RETURNING "version"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started POST "/users" for ::1 at 2023-11-06 13:41:44 +0100
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by UsersController#create as */*
  Parameters: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "user"=>{"full_name"=>"Super Admin", "email"=>"admin@test.dk"}}
[31mUnpermitted parameter: :user. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x00007f4687f712d0>, params: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "controller"=>"users", "action"=>"create", "user"=>{"full_name"=>"Super Admin", "email"=>"admin@test.dk"}} }[0m
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "admin@test.dk"], ["LIMIT", 1]]
  â†³ app/controllers/users_controller.rb:8:in `create'
  [1m[36mCACHE User Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "admin@test.dk"], ["LIMIT", 1]]
  â†³ app/controllers/users_controller.rb:9:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/controllers/users_controller.rb:9:in `create'
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("full_name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["full_name", "Super Admin"], ["email", "admin@test.dk"], ["password_digest", "[FILTERED]"], ["created_at", "2023-11-06 12:41:44.989648"], ["updated_at", "2023-11-06 12:41:44.989648"]]
  â†³ app/controllers/users_controller.rb:9:in `create'
  [1m[36mTRANSACTION (6.3ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/controllers/users_controller.rb:9:in `create'
Completed 200 OK in 214ms (Views: 0.2ms | ActiveRecord: 7.6ms | Allocations: 17486)


Started GET "/users" for ::1 at 2023-11-06 13:41:49 +0100
Processing by UsersController#index as */*
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users"[0m
  â†³ app/controllers/users_controller.rb:3:in `index'
Completed 200 OK in 1ms (Views: 0.8ms | ActiveRecord: 0.1ms | Allocations: 806)


Started POST "/users" for ::1 at 2023-11-06 13:41:54 +0100
Processing by UsersController#create as */*
  Parameters: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "user"=>{"full_name"=>"Super Admin", "email"=>"admin@test.dk"}}
[31mUnpermitted parameter: :user. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x00007f4687f79070>, params: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "controller"=>"users", "action"=>"create", "user"=>{"full_name"=>"Super Admin", "email"=>"admin@test.dk"}} }[0m
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "admin@test.dk"], ["LIMIT", 1]]
  â†³ app/controllers/users_controller.rb:8:in `create'
Completed 200 OK in 171ms (Views: 0.1ms | ActiveRecord: 0.1ms | Allocations: 835)


Started POST "/users" for ::1 at 2023-11-06 13:43:38 +0100
  
ArgumentError (Unknown validator: 'LenghtValidator'):
  
app/models/user.rb:3:in `<class:User>'
app/models/user.rb:1:in `<main>'
Started POST "/users" for ::1 at 2023-11-06 13:44:13 +0100
Processing by UsersController#create as */*
  Parameters: {"email"=>"admin2@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "user"=>{"full_name"=>"Super Admin", "email"=>"admin2@test.dk"}}
[31mUnpermitted parameter: :user. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x00007f468523f5a0>, params: {"email"=>"admin2@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "controller"=>"users", "action"=>"create", "user"=>{"full_name"=>"Super Admin", "email"=>"admin2@test.dk"}} }[0m
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "admin2@test.dk"], ["LIMIT", 1]]
  â†³ app/controllers/users_controller.rb:8:in `create'
  [1m[36mCACHE User Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "admin2@test.dk"], ["LIMIT", 1]]
  â†³ app/controllers/users_controller.rb:9:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/controllers/users_controller.rb:9:in `create'
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("full_name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["full_name", "Super Admin"], ["email", "admin2@test.dk"], ["password_digest", "[FILTERED]"], ["created_at", "2023-11-06 12:44:13.877506"], ["updated_at", "2023-11-06 12:44:13.877506"]]
  â†³ app/controllers/users_controller.rb:9:in `create'
  [1m[36mTRANSACTION (4.7ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/controllers/users_controller.rb:9:in `create'
Completed 200 OK in 178ms (Views: 0.1ms | ActiveRecord: 6.7ms | Allocations: 5688)


Started POST "/users" for ::1 at 2023-11-06 13:46:22 +0100
Processing by UsersController#create as */*
  Parameters: {"email"=>"admin3@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "user"=>{"full_name"=>"Super Admin", "email"=>"admin3@test.dk"}}
[31mUnpermitted parameter: :user. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x00007f468531d030>, params: {"email"=>"admin3@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "controller"=>"users", "action"=>"create", "user"=>{"full_name"=>"Super Admin", "email"=>"admin3@test.dk"}} }[0m
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "admin3@test.dk"], ["LIMIT", 1]]
  â†³ app/controllers/users_controller.rb:8:in `create'
  [1m[36mCACHE User Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "admin3@test.dk"], ["LIMIT", 1]]
  â†³ app/controllers/users_controller.rb:9:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/controllers/users_controller.rb:9:in `create'
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("full_name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["full_name", "Super Admin"], ["email", "admin3@test.dk"], ["password_digest", "[FILTERED]"], ["created_at", "2023-11-06 12:46:23.133843"], ["updated_at", "2023-11-06 12:46:23.133843"]]
  â†³ app/controllers/users_controller.rb:9:in `create'
  [1m[36mTRANSACTION (5.3ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/controllers/users_controller.rb:9:in `create'
Completed 200 OK in 176ms (Views: 0.1ms | ActiveRecord: 7.1ms | Allocations: 5619)


Started POST "/users" for ::1 at 2023-11-06 13:46:38 +0100
Processing by UsersController#create as */*
  Parameters: {"email"=>"admin4@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "user"=>{"full_name"=>"Super Admin", "email"=>"admin4@test.dk"}}
[31mUnpermitted parameter: :user. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x00007f468523b360>, params: {"email"=>"admin4@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "controller"=>"users", "action"=>"create", "user"=>{"full_name"=>"Super Admin", "email"=>"admin4@test.dk"}} }[0m
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "admin4@test.dk"], ["LIMIT", 1]]
  â†³ app/controllers/users_controller.rb:8:in `create'
  [1m[36mCACHE User Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "admin4@test.dk"], ["LIMIT", 1]]
  â†³ app/controllers/users_controller.rb:9:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/controllers/users_controller.rb:9:in `create'
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("full_name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["full_name", "Super Admin"], ["email", "admin4@test.dk"], ["password_digest", "[FILTERED]"], ["created_at", "2023-11-06 12:46:38.602297"], ["updated_at", "2023-11-06 12:46:38.602297"]]
  â†³ app/controllers/users_controller.rb:9:in `create'
  [1m[36mTRANSACTION (4.9ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/controllers/users_controller.rb:9:in `create'
Completed 200 OK in 176ms (Views: 0.1ms | ActiveRecord: 6.9ms | Allocations: 5634)


Started POST "/users" for ::1 at 2023-11-06 13:57:58 +0100
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by UsersController#create as */*
  Parameters: {"email"=>"admin5@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "user"=>{"full_name"=>"Super Admin", "email"=>"admin5@test.dk"}}
[31mUnpermitted parameter: :user. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x00007f5a4b1ffa20>, params: {"email"=>"admin5@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "controller"=>"users", "action"=>"create", "user"=>{"full_name"=>"Super Admin", "email"=>"admin5@test.dk"}} }[0m
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "admin5@test.dk"], ["LIMIT", 1]]
  â†³ app/controllers/users_controller.rb:8:in `create'
  [1m[36mCACHE User Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "admin5@test.dk"], ["LIMIT", 1]]
  â†³ app/controllers/users_controller.rb:9:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/controllers/users_controller.rb:9:in `create'
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("full_name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["full_name", "Super Admin"], ["email", "admin5@test.dk"], ["password_digest", "[FILTERED]"], ["created_at", "2023-11-06 12:57:58.397041"], ["updated_at", "2023-11-06 12:57:58.397041"]]
  â†³ app/controllers/users_controller.rb:9:in `create'
  [1m[36mTRANSACTION (5.1ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/controllers/users_controller.rb:9:in `create'
Completed 200 OK in 206ms (Views: 0.2ms | ActiveRecord: 6.2ms | Allocations: 17125)


Started POST "/users" for ::1 at 2023-11-06 13:59:30 +0100
Processing by UsersController#create as */*
  Parameters: {"email"=>"admin6@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "user"=>{"full_name"=>"Super Admin", "email"=>"admin6@test.dk"}}
[31mUnpermitted parameter: :user. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x00007f5a486406f0>, params: {"email"=>"admin6@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "controller"=>"users", "action"=>"create", "user"=>{"full_name"=>"Super Admin", "email"=>"admin6@test.dk"}} }[0m
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "admin6@test.dk"], ["LIMIT", 1]]
  â†³ app/controllers/users_controller.rb:8:in `create'
Completed 200 OK in 169ms (Views: 0.1ms | ActiveRecord: 1.3ms | Allocations: 3632)


Started POST "/users" for ::1 at 2023-11-06 13:59:57 +0100
  
ArgumentError (Unknown validator: 'MessageValidator'):
  
app/models/user.rb:4:in `<class:User>'
app/models/user.rb:1:in `<main>'
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateUsersTable (20231106120630)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.4ms)[0m  [1m[35mDROP INDEX "index_users_on_email"[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE "users"[0m
  [1m[36mActiveRecord::SchemaMigration Destroy (0.0ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = '20231106120630'[0m
  [1m[36mTRANSACTION (7.7ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateUsersTable (20231106120630)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "full_name" varchar, "email" varchar, "password_digest" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_users_on_email" ON "users" ("email")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20231106120630') RETURNING "version"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started POST "/users" for ::1 at 2023-11-06 14:01:09 +0100
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by UsersController#create as */*
  Parameters: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "user"=>{"full_name"=>"Super Admin", "email"=>"admin@test.dk"}}
[31mUnpermitted parameter: :user. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x00007f7abe6bf3d8>, params: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "controller"=>"users", "action"=>"create", "user"=>{"full_name"=>"Super Admin", "email"=>"admin@test.dk"}} }[0m
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "admin@test.dk"], ["LIMIT", 1]]
  â†³ app/controllers/users_controller.rb:8:in `create'
  [1m[36mCACHE User Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "admin@test.dk"], ["LIMIT", 1]]
  â†³ app/controllers/users_controller.rb:9:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/controllers/users_controller.rb:9:in `create'
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("full_name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["full_name", "Super Admin"], ["email", "admin@test.dk"], ["password_digest", "[FILTERED]"], ["created_at", "2023-11-06 13:01:09.824212"], ["updated_at", "2023-11-06 13:01:09.824212"]]
  â†³ app/controllers/users_controller.rb:9:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/controllers/users_controller.rb:9:in `create'
Completed 200 OK in 199ms (Views: 0.1ms | ActiveRecord: 1.1ms | Allocations: 17128)


Started GET "/users" for ::1 at 2023-11-06 14:01:14 +0100
Processing by UsersController#index as */*
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users"[0m
  â†³ app/controllers/users_controller.rb:3:in `index'
Completed 200 OK in 1ms (Views: 0.9ms | ActiveRecord: 0.1ms | Allocations: 805)


Started POST "/users" for ::1 at 2023-11-06 15:51:51 +0100
Processing by UsersController#create as */*
  Parameters: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "user"=>{"full_name"=>"Super Admin", "email"=>"admin@test.dk"}}
[31mUnpermitted parameter: :user. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x00007f7a8fae6c38>, params: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "controller"=>"users", "action"=>"create", "user"=>{"full_name"=>"Super Admin", "email"=>"admin@test.dk"}} }[0m
  [1m[36mUser Exists? (4.9ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "admin@test.dk"], ["LIMIT", 1]]
  â†³ app/controllers/users_controller.rb:8:in `create'
Completed 200 OK in 177ms (Views: 0.1ms | ActiveRecord: 7.4ms | Allocations: 3781)


Started POST "/users" for ::1 at 2023-11-06 15:51:53 +0100
Processing by UsersController#create as */*
  Parameters: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "user"=>{"full_name"=>"Super Admin", "email"=>"admin@test.dk"}}
[31mUnpermitted parameter: :user. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x00007f7abe653f20>, params: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "controller"=>"users", "action"=>"create", "user"=>{"full_name"=>"Super Admin", "email"=>"admin@test.dk"}} }[0m
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "admin@test.dk"], ["LIMIT", 1]]
  â†³ app/controllers/users_controller.rb:8:in `create'
Completed 200 OK in 168ms (Views: 0.1ms | ActiveRecord: 0.1ms | Allocations: 838)


Started POST "/users" for ::1 at 2023-11-06 15:51:58 +0100
Processing by UsersController#create as */*
  Parameters: {"email"=>"admin2@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "user"=>{"full_name"=>"Super Admin", "email"=>"admin2@test.dk"}}
[31mUnpermitted parameter: :user. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x00007f7abd9bc0a0>, params: {"email"=>"admin2@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "controller"=>"users", "action"=>"create", "user"=>{"full_name"=>"Super Admin", "email"=>"admin2@test.dk"}} }[0m
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "admin2@test.dk"], ["LIMIT", 1]]
  â†³ app/controllers/users_controller.rb:8:in `create'
  [1m[36mCACHE User Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "admin2@test.dk"], ["LIMIT", 1]]
  â†³ app/controllers/users_controller.rb:9:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/controllers/users_controller.rb:9:in `create'
  [1m[36mUser Create (0.9ms)[0m  [1m[32mINSERT INTO "users" ("full_name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["full_name", "Super Admin"], ["email", "admin2@test.dk"], ["password_digest", "[FILTERED]"], ["created_at", "2023-11-06 14:51:58.176495"], ["updated_at", "2023-11-06 14:51:58.176495"]]
  â†³ app/controllers/users_controller.rb:9:in `create'
  [1m[36mTRANSACTION (5.4ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/controllers/users_controller.rb:9:in `create'
Completed 200 OK in 176ms (Views: 0.1ms | ActiveRecord: 6.4ms | Allocations: 2798)


Started GET "/users" for ::1 at 2023-11-06 15:58:03 +0100
Processing by UsersController#index as */*
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT "users".* FROM "users"[0m
  â†³ app/controllers/users_controller.rb:3:in `index'
Completed 200 OK in 9ms (Views: 4.9ms | ActiveRecord: 1.7ms | Allocations: 4345)


Started POST "/users" for ::1 at 2023-11-06 15:58:05 +0100
Processing by UsersController#create as */*
  Parameters: {"email"=>"admin2@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "user"=>{"full_name"=>"Super Admin", "email"=>"admin2@test.dk"}}
[31mUnpermitted parameter: :user. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x00007f7a8fa77db0>, params: {"email"=>"admin2@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "controller"=>"users", "action"=>"create", "user"=>{"full_name"=>"Super Admin", "email"=>"admin2@test.dk"}} }[0m
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "admin2@test.dk"], ["LIMIT", 1]]
  â†³ app/controllers/users_controller.rb:8:in `create'
Completed 200 OK in 174ms (Views: 7.4ms | ActiveRecord: 0.1ms | Allocations: 3436)


Started POST "/users" for ::1 at 2023-11-06 15:58:28 +0100
Processing by UsersController#create as */*
  Parameters: {"email"=>"admin2@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "user"=>{"full_name"=>"Super Admin", "email"=>"admin2@test.dk"}}
[31mUnpermitted parameter: :user. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x00007f7a8fa479f8>, params: {"email"=>"admin2@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "controller"=>"users", "action"=>"create", "user"=>{"full_name"=>"Super Admin", "email"=>"admin2@test.dk"}} }[0m
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "admin2@test.dk"], ["LIMIT", 1]]
  â†³ app/controllers/users_controller.rb:8:in `create'
Completed 200 OK in 181ms (Views: 0.4ms | ActiveRecord: 0.1ms | Allocations: 1338)


Started POST "/postman" for ::1 at 2023-11-06 16:22:07 +0100
  
ActionController::RoutingError (No route matches [POST] "/postman"):
  
Started POST "/sessions" for ::1 at 2023-11-06 16:22:13 +0100
Processing by SessionsController#create as */*
  Parameters: {"email"=>"admin@admin.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "session"=>{"email"=>"admin@admin.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}}
[31mUnpermitted parameters: :full_name, :session. Context: { controller: SessionsController, action: create, request: #<ActionDispatch::Request:0x00007f7abd9b0340>, params: {"email"=>"admin@admin.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "controller"=>"sessions", "action"=>"create", "session"=>{"email"=>"admin@admin.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}} }[0m
  [1m[36mUser Load (1.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", nil], ["LIMIT", 1]]
  â†³ app/controllers/sessions_controller.rb:3:in `create'
Completed 404 Not Found in 8ms (ActiveRecord: 2.1ms | Allocations: 2290)


  
ActiveRecord::RecordNotFound (Couldn't find User with 'id'={:email=>"admin@admin.dk"}):
  
app/controllers/sessions_controller.rb:3:in `create'
Started POST "/sessions" for ::1 at 2023-11-06 16:22:40 +0100
Processing by SessionsController#create as */*
  Parameters: {"email"=>"admin@admin.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "session"=>{"email"=>"admin@admin.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}}
[31mUnpermitted parameters: :full_name, :session. Context: { controller: SessionsController, action: create, request: #<ActionDispatch::Request:0x00007f7a8f9bda28>, params: {"email"=>"admin@admin.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "controller"=>"sessions", "action"=>"create", "session"=>{"email"=>"admin@admin.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}} }[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? /* loading for inspect */ LIMIT ?[0m  [["email", "admin@admin.dk"], ["LIMIT", 11]]
Completed 500 Internal Server Error in 4ms (ActiveRecord: 1.5ms | Allocations: 2744)


  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? /* loading for inspect */ LIMIT ?[0m  [["email", "admin@admin.dk"], ["LIMIT", 11]]
  
NoMethodError (undefined method `password' for #<ActiveRecord::Relation []>):
  
app/controllers/sessions_controller.rb:9:in `create'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? /* loading for inspect */ LIMIT ?[0m  [["email", "admin@admin.dk"], ["LIMIT", 11]]
Started POST "/sessions" for ::1 at 2023-11-06 16:22:51 +0100
Processing by SessionsController#create as */*
  Parameters: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "session"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}}
[31mUnpermitted parameters: :full_name, :session. Context: { controller: SessionsController, action: create, request: #<ActionDispatch::Request:0x00007f7a8fa61880>, params: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "controller"=>"sessions", "action"=>"create", "session"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}} }[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? /* loading for inspect */ LIMIT ?[0m  [["email", "admin@test.dk"], ["LIMIT", 11]]
Completed 500 Internal Server Error in 5ms (ActiveRecord: 0.0ms | Allocations: 3636)


  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? /* loading for inspect */ LIMIT ?[0m  [["email", "admin@test.dk"], ["LIMIT", 11]]
  
NoMethodError (undefined method `password' for #<ActiveRecord::Relation [#<User id: 1, full_name: "Super Admin", email: "admin@test.dk", password_digest: [FILTERED], created_at: "2023-11-06 13:01:09.824212000 +0000", updated_at: "2023-11-06 13:01:09.824212000 +0000">]>):
  
app/controllers/sessions_controller.rb:9:in `create'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? /* loading for inspect */ LIMIT ?[0m  [["email", "admin@test.dk"], ["LIMIT", 11]]
Started POST "/sessions" for ::1 at 2023-11-06 16:23:27 +0100
Processing by SessionsController#create as */*
  Parameters: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "session"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}}
[31mUnpermitted parameters: :full_name, :session. Context: { controller: SessionsController, action: create, request: #<ActionDispatch::Request:0x00007f7a8f99d3e0>, params: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "controller"=>"sessions", "action"=>"create", "session"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}} }[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "admin@test.dk"], ["LIMIT", 1]]
  â†³ app/controllers/sessions_controller.rb:3:in `create'
[31mUnpermitted parameters: :full_name, :session. Context: { controller: SessionsController, action: create, request: #<ActionDispatch::Request:0x00007f7a8f99d3e0>, params: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "controller"=>"sessions", "action"=>"create", "session"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}} }[0m
Completed 204 No Content in 6ms (ActiveRecord: 1.2ms | Allocations: 4959)


Started POST "/sessions" for ::1 at 2023-11-06 16:23:47 +0100
Processing by SessionsController#create as */*
  Parameters: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "session"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}}
[31mUnpermitted parameters: :full_name, :session. Context: { controller: SessionsController, action: create, request: #<ActionDispatch::Request:0x00007f7a8fa42a98>, params: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "controller"=>"sessions", "action"=>"create", "session"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}} }[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "admin@test.dk"], ["LIMIT", 1]]
  â†³ app/controllers/sessions_controller.rb:3:in `create'
[31mUnpermitted parameters: :full_name, :session. Context: { controller: SessionsController, action: create, request: #<ActionDispatch::Request:0x00007f7a8fa42a98>, params: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "controller"=>"sessions", "action"=>"create", "session"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}} }[0m
Completed 401 Unauthorized in 6ms (Views: 0.2ms | ActiveRecord: 1.0ms | Allocations: 4925)


Started POST "/sessions" for ::1 at 2023-11-06 16:24:14 +0100
Processing by SessionsController#create as */*
  Parameters: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "session"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}}
[31mUnpermitted parameters: :full_name, :session. Context: { controller: SessionsController, action: create, request: #<ActionDispatch::Request:0x00007f7a8fa70830>, params: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "controller"=>"sessions", "action"=>"create", "session"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}} }[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "admin@test.dk"], ["LIMIT", 1]]
  â†³ app/controllers/sessions_controller.rb:3:in `create'
[31mUnpermitted parameters: :full_name, :session. Context: { controller: SessionsController, action: create, request: #<ActionDispatch::Request:0x00007f7a8fa70830>, params: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "controller"=>"sessions", "action"=>"create", "session"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}} }[0m
Completed 401 Unauthorized in 1ms (Views: 0.1ms | ActiveRecord: 0.1ms | Allocations: 678)


Started POST "/sessions" for ::1 at 2023-11-06 16:24:20 +0100
Processing by SessionsController#create as */*
  Parameters: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "session"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}}
[31mUnpermitted parameters: :full_name, :session. Context: { controller: SessionsController, action: create, request: #<ActionDispatch::Request:0x00007f7abe45b2e0>, params: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "controller"=>"sessions", "action"=>"create", "session"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}} }[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? /* loading for inspect */ LIMIT ?[0m  [["email", "admin@test.dk"], ["LIMIT", 11]]
Completed 500 Internal Server Error in 6ms (ActiveRecord: 1.0ms | Allocations: 5260)


  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? /* loading for inspect */ LIMIT ?[0m  [["email", "admin@test.dk"], ["LIMIT", 11]]
  
NoMethodError (undefined method `password' for #<ActiveRecord::Relation [#<User id: 1, full_name: "Super Admin", email: "admin@test.dk", password_digest: [FILTERED], created_at: "2023-11-06 13:01:09.824212000 +0000", updated_at: "2023-11-06 13:01:09.824212000 +0000">]>):
  
app/controllers/sessions_controller.rb:9:in `create'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? /* loading for inspect */ LIMIT ?[0m  [["email", "admin@test.dk"], ["LIMIT", 11]]
Started POST "/sessions" for ::1 at 2023-11-06 16:24:36 +0100
Processing by SessionsController#create as */*
  Parameters: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "session"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}}
[31mUnpermitted parameters: :full_name, :session. Context: { controller: SessionsController, action: create, request: #<ActionDispatch::Request:0x00007f7a8f839080>, params: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "controller"=>"sessions", "action"=>"create", "session"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}} }[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "admin@test.dk"], ["LIMIT", 1]]
  â†³ app/controllers/sessions_controller.rb:3:in `create'
Completed 500 Internal Server Error in 6ms (ActiveRecord: 1.4ms | Allocations: 4851)


  
NameError (undefined local variable or method `byebug' for #<SessionsController:0x000000000216d8>):
  
app/controllers/sessions_controller.rb:9:in `create'
Started POST "/sessions" for ::1 at 2023-11-06 16:24:39 +0100
Processing by SessionsController#create as */*
  Parameters: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "session"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}}
[31mUnpermitted parameters: :full_name, :session. Context: { controller: SessionsController, action: create, request: #<ActionDispatch::Request:0x00007f7a8f999920>, params: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "controller"=>"sessions", "action"=>"create", "session"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}} }[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "admin@test.dk"], ["LIMIT", 1]]
  â†³ app/controllers/sessions_controller.rb:3:in `create'
Completed 500 Internal Server Error in 1ms (ActiveRecord: 0.1ms | Allocations: 568)


  
NameError (undefined local variable or method `byebug' for #<SessionsController:0x00000000021750>):
  
app/controllers/sessions_controller.rb:9:in `create'
Started POST "/sessions" for ::1 at 2023-11-06 16:25:19 +0100
Processing by SessionsController#create as */*
  Parameters: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "session"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}}
[31mUnpermitted parameters: :full_name, :session. Context: { controller: SessionsController, action: create, request: #<ActionDispatch::Request:0x00007f7a8fa81d60>, params: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "controller"=>"sessions", "action"=>"create", "session"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}} }[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "admin@test.dk"], ["LIMIT", 1]]
  â†³ app/controllers/sessions_controller.rb:3:in `create'
Completed 500 Internal Server Error in 2ms (ActiveRecord: 0.1ms | Allocations: 568)


  
NameError (undefined local variable or method `byebug' for #<SessionsController:0x000000000217c8>):
  
app/controllers/sessions_controller.rb:9:in `create'
Started POST "/sessions" for ::1 at 2023-11-06 16:25:20 +0100
Processing by SessionsController#create as */*
  Parameters: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "session"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}}
[31mUnpermitted parameters: :full_name, :session. Context: { controller: SessionsController, action: create, request: #<ActionDispatch::Request:0x00007f7a8fa974f8>, params: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "controller"=>"sessions", "action"=>"create", "session"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}} }[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "admin@test.dk"], ["LIMIT", 1]]
  â†³ app/controllers/sessions_controller.rb:3:in `create'
Completed 500 Internal Server Error in 1ms (ActiveRecord: 0.1ms | Allocations: 568)


  
NameError (undefined local variable or method `byebug' for #<SessionsController:0x00000000021868>):
  
app/controllers/sessions_controller.rb:9:in `create'
Started POST "/sessions" for ::1 at 2023-11-06 16:25:30 +0100
Processing by SessionsController#create as */*
  Parameters: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "session"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}}
[31mUnpermitted parameters: :full_name, :session. Context: { controller: SessionsController, action: create, request: #<ActionDispatch::Request:0x00007f7a8fa03848>, params: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "controller"=>"sessions", "action"=>"create", "session"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}} }[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "admin@test.dk"], ["LIMIT", 1]]
  â†³ app/controllers/sessions_controller.rb:3:in `create'
Completed 500 Internal Server Error in 2ms (ActiveRecord: 0.1ms | Allocations: 569)


  
NameError (undefined local variable or method `byebug' for #<SessionsController:0x000000000218e0>):
  
app/controllers/sessions_controller.rb:9:in `create'
Started POST "/sessions" for ::1 at 2023-11-06 16:25:43 +0100
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by SessionsController#create as */*
  Parameters: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "session"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}}
[31mUnpermitted parameters: :full_name, :session. Context: { controller: SessionsController, action: create, request: #<ActionDispatch::Request:0x00007f62f9fca798>, params: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "controller"=>"sessions", "action"=>"create", "session"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}} }[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "admin@test.dk"], ["LIMIT", 1]]
  â†³ app/controllers/sessions_controller.rb:3:in `create'
[31mUnpermitted parameters: :full_name, :session. Context: { controller: SessionsController, action: create, request: #<ActionDispatch::Request:0x00007f62f9fca798>, params: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "controller"=>"sessions", "action"=>"create", "session"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}} }[0m
[31mUnpermitted parameters: :full_name, :session. Context: { controller: SessionsController, action: create, request: #<ActionDispatch::Request:0x00007f62f9fca798>, params: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "controller"=>"sessions", "action"=>"create", "session"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}} }[0m
[31mUnpermitted parameters: :full_name, :session. Context: { controller: SessionsController, action: create, request: #<ActionDispatch::Request:0x00007f62f9fca798>, params: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "controller"=>"sessions", "action"=>"create", "session"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}} }[0m
[31mUnpermitted parameters: :full_name, :session. Context: { controller: SessionsController, action: create, request: #<ActionDispatch::Request:0x00007f62f9fca798>, params: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "controller"=>"sessions", "action"=>"create", "session"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}} }[0m
[31mUnpermitted parameters: :full_name, :session. Context: { controller: SessionsController, action: create, request: #<ActionDispatch::Request:0x00007f62f9fca798>, params: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "controller"=>"sessions", "action"=>"create", "session"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}} }[0m
[31mUnpermitted parameters: :full_name, :session. Context: { controller: SessionsController, action: create, request: #<ActionDispatch::Request:0x00007f62f9fca798>, params: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "controller"=>"sessions", "action"=>"create", "session"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}} }[0m
[31mUnpermitted parameters: :full_name, :session. Context: { controller: SessionsController, action: create, request: #<ActionDispatch::Request:0x00007f62f9fca798>, params: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "controller"=>"sessions", "action"=>"create", "session"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}} }[0m
Completed 401 Unauthorized in 137372ms (Views: 0.6ms | ActiveRecord: 0.5ms | Allocations: 91254)


Started POST "/sessions" for ::1 at 2023-11-06 16:28:07 +0100
Processing by SessionsController#create as */*
  Parameters: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "session"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}}
[31mUnpermitted parameters: :full_name, :session. Context: { controller: SessionsController, action: create, request: #<ActionDispatch::Request:0x00007f62f9713e88>, params: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "controller"=>"sessions", "action"=>"create", "session"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}} }[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "admin@test.dk"], ["LIMIT", 1]]
  â†³ app/controllers/sessions_controller.rb:3:in `create'
[31mUnpermitted parameters: :full_name, :session. Context: { controller: SessionsController, action: create, request: #<ActionDispatch::Request:0x00007f62f9713e88>, params: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "controller"=>"sessions", "action"=>"create", "session"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}} }[0m
DEPRECATION WARNING: `Rails.application.secrets` is deprecated in favor of `Rails.application.credentials` and will be removed in Rails 7.2. (called from <class:JwtService> at /home/topper/rails_test/products_api/app/services/jwt_service.rb:2)
Completed 200 OK in 178ms (Views: 0.1ms | ActiveRecord: 1.5ms | Allocations: 6565)


  [1m[36mActiveRecord::InternalMetadata Load (0.6ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateProducts (20231106215035)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (1.9ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "description" text, "price" integer, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20231106215035') RETURNING "version"[0m
  [1m[36mTRANSACTION (5.5ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started GET "/products" for ::1 at 2023-11-06 22:59:44 +0100
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  
SyntaxError (/home/topper/rails_test/products_api/app/controllers/products_controller.rb:5: syntax error, unexpected local variable or method, expecting '}'
...: { message: 'success' products: Product.all }
...                       ^~~~~~~~
):
  
app/controllers/products_controller.rb:5: syntax error, unexpected local variable or method, expecting '}'
Started GET "/products" for ::1 at 2023-11-06 23:00:54 +0100
  
ArgumentError (Unknown key: :presence. Valid keys are: :on, :if, :unless, :prepend. Perhaps you meant to call `validates` instead of `validate`?):
  
app/models/product.rb:2:in `<class:Product>'
app/models/product.rb:1:in `<main>'
Started GET "/products" for ::1 at 2023-11-06 23:01:17 +0100
Processing by ProductsController#index as */*
  Parameters: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "product"=>{}}
Completed 500 Internal Server Error in 4ms (ActiveRecord: 4.3ms | Allocations: 249)


  
AbstractController::DoubleRenderError (Render and/or redirect were called multiple times in this action. Please note that you may only call render OR redirect, and at most once per action. Also note that neither redirect nor render terminate execution of the action, so if you want to exit an action after redirecting, you need to do something like "redirect_to(...); return".):
  
app/controllers/application_controller.rb:6:in `authorize'
Started GET "/products" for ::1 at 2023-11-06 23:02:29 +0100
Processing by ProductsController#index as */*
  Parameters: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "product"=>{}}
Completed 500 Internal Server Error in 0ms (ActiveRecord: 1.3ms | Allocations: 214)


  
AbstractController::DoubleRenderError (Render and/or redirect were called multiple times in this action. Please note that you may only call render OR redirect, and at most once per action. Also note that neither redirect nor render terminate execution of the action, so if you want to exit an action after redirecting, you need to do something like "redirect_to(...); return".):
  
app/controllers/application_controller.rb:6:in `authorize'
Started GET "/products" for ::1 at 2023-11-06 23:03:29 +0100
Processing by ProductsController#index as */*
  Parameters: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "product"=>{}}
DEPRECATION WARNING: `Rails.application.secrets` is deprecated in favor of `Rails.application.credentials` and will be removed in Rails 7.2. (called from <class:JwtService> at /home/topper/rails_test/products_api/app/services/jwt_service.rb:2)
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:18:in `from_jwt'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:18:in `from_jwt'
Completed 500 Internal Server Error in 52173ms (ActiveRecord: 4.6ms | Allocations: 10310)


  
AbstractController::DoubleRenderError (Render and/or redirect were called multiple times in this action. Please note that you may only call render OR redirect, and at most once per action. Also note that neither redirect nor render terminate execution of the action, so if you want to exit an action after redirecting, you need to do something like "redirect_to(...); return".):
  
app/controllers/application_controller.rb:7:in `authorize'
Started GET "/products" for ::1 at 2023-11-06 23:04:37 +0100
Processing by ProductsController#index as */*
  Parameters: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "product"=>{}}
DEPRECATION WARNING: `Rails.application.secrets` is deprecated in favor of `Rails.application.credentials` and will be removed in Rails 7.2. (called from <class:JwtService> at /home/topper/rails_test/products_api/app/services/jwt_service.rb:2)
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:18:in `from_jwt'
  [1m[36mProduct Load (0.1ms)[0m  [1m[34mSELECT "products".* FROM "products"[0m
  â†³ app/controllers/products_controller.rb:5:in `index'
Completed 200 OK in 9ms (Views: 1.8ms | ActiveRecord: 1.8ms | Allocations: 5044)


Started GET "/products" for ::1 at 2023-11-06 23:04:41 +0100
Processing by ProductsController#index as */*
  Parameters: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "product"=>{}}
Completed 500 Internal Server Error in 0ms (ActiveRecord: 0.0ms | Allocations: 149)


  
AbstractController::DoubleRenderError (Render and/or redirect were called multiple times in this action. Please note that you may only call render OR redirect, and at most once per action. Also note that neither redirect nor render terminate execution of the action, so if you want to exit an action after redirecting, you need to do something like "redirect_to(...); return".):
  
app/controllers/application_controller.rb:6:in `authorize'
Started GET "/products" for ::1 at 2023-11-06 23:05:10 +0100
Processing by ProductsController#index as */*
  Parameters: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "product"=>{}}
Completed 500 Internal Server Error in 0ms (ActiveRecord: 3.3ms | Allocations: 211)


  
AbstractController::DoubleRenderError (Render and/or redirect were called multiple times in this action. Please note that you may only call render OR redirect, and at most once per action. Also note that neither redirect nor render terminate execution of the action, so if you want to exit an action after redirecting, you need to do something like "redirect_to(...); return".):
  
app/controllers/application_controller.rb:6:in `authorize'
Started GET "/products" for ::1 at 2023-11-06 23:05:29 +0100
Processing by ProductsController#index as */*
  Parameters: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "product"=>{}}
Completed 500 Internal Server Error in 1ms (ActiveRecord: 1.0ms | Allocations: 211)


  
AbstractController::DoubleRenderError (Render and/or redirect were called multiple times in this action. Please note that you may only call render OR redirect, and at most once per action. Also note that neither redirect nor render terminate execution of the action, so if you want to exit an action after redirecting, you need to do something like "redirect_to(...); return".):
  
app/controllers/application_controller.rb:6:in `authorize'
Started GET "/products" for ::1 at 2023-11-06 23:05:54 +0100
Processing by ProductsController#index as */*
  Parameters: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "product"=>{}}
Filter chain halted as :authorize rendered or redirected
Completed 401 Unauthorized in 0ms (Views: 0.1ms | ActiveRecord: 1.7ms | Allocations: 179)


  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started GET "/products" for ::1 at 2023-11-06 23:10:30 +0100
Processing by ProductsController#index as */*
  Parameters: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "product"=>{}}
DEPRECATION WARNING: `Rails.application.secrets` is deprecated in favor of `Rails.application.credentials` and will be removed in Rails 7.2. (called from <class:JwtService> at /home/topper/rails_test/products_api/app/services/jwt_service.rb:2)
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:18:in `from_jwt'
  [1m[36mProduct Load (0.1ms)[0m  [1m[34mSELECT "products".* FROM "products"[0m
  â†³ app/controllers/products_controller.rb:5:in `index'
Completed 200 OK in 12ms (Views: 0.8ms | ActiveRecord: 2.1ms | Allocations: 5005)


  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateBasket (20231107115131)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE TABLE "baskets" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "user_id" integer, "product_id" integer, "amount" integer, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20231107115131') RETURNING "version"[0m
  [1m[36mTRANSACTION (6.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started GET "/users/1/baskets" for ::1 at 2023-11-07 13:02:33 +0100
  
SyntaxError (/home/topper/rails_test/products_api/config/routes.rb:3: syntax error, unexpected [, expecting `do' or '{' or '('
    resources :baskets, only [:index]
                             ^
):
  
config/routes.rb:3: syntax error, unexpected [, expecting `do' or '{' or '('
Started GET "/users/1/baskets" for ::1 at 2023-11-07 13:02:47 +0100
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by BasketsController#index as */*
  Parameters: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "user_id"=>"1", "basket"=>{}}
Completed 200 OK in 99064ms (Views: 0.3ms | ActiveRecord: 0.2ms | Allocations: 62027)


Started GET "/users/1/baskets" for ::1 at 2023-11-07 13:04:28 +0100
Processing by BasketsController#index as */*
  Parameters: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "user_id"=>"1", "basket"=>{}}
DEPRECATION WARNING: `Rails.application.secrets` is deprecated in favor of `Rails.application.credentials` and will be removed in Rails 7.2. (called from <class:JwtService> at /home/topper/rails_test/products_api/app/services/jwt_service.rb:2)
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:21:in `from_jwt'
Completed 200 OK in 84496ms (Views: 0.2ms | ActiveRecord: 3.0ms | Allocations: 26933)


Started GET "/users/1/baskets" for ::1 at 2023-11-07 13:05:56 +0100
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by BasketsController#index as */*
  Parameters: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "user_id"=>"1", "basket"=>{}}
DEPRECATION WARNING: `Rails.application.secrets` is deprecated in favor of `Rails.application.credentials` and will be removed in Rails 7.2. (called from <class:JwtService> at /home/topper/rails_test/products_api/app/services/jwt_service.rb:2)
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:21:in `from_jwt'
Completed 200 OK in 37205ms (Views: 0.2ms | ActiveRecord: 0.5ms | Allocations: 63430)


Started GET "/users/1/baskets" for ::1 at 2023-11-07 13:06:37 +0100
Processing by BasketsController#index as */*
  Parameters: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "user_id"=>"1", "basket"=>{}}
Completed 200 OK in 4ms (Views: 0.1ms | ActiveRecord: 1.0ms | Allocations: 3018)


Started GET "/users/1/baskets" for ::1 at 2023-11-07 13:06:39 +0100
Processing by BasketsController#index as */*
  Parameters: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "user_id"=>"1", "basket"=>{}}
DEPRECATION WARNING: `Rails.application.secrets` is deprecated in favor of `Rails.application.credentials` and will be removed in Rails 7.2. (called from <class:JwtService> at /home/topper/rails_test/products_api/app/services/jwt_service.rb:2)
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:21:in `from_jwt'
  [1m[36mBasket Load (0.1ms)[0m  [1m[34mSELECT "baskets".* FROM "baskets" WHERE "baskets"."user_id" = ? /* loading for inspect */ LIMIT ?[0m  [["user_id", 1], ["LIMIT", 11]]
  â†³ app/controllers/baskets_controller.rb:4:in `index'
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateBasket (20231107115131)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (1.1ms)[0m  [1m[35mDROP TABLE "baskets"[0m
  [1m[36mActiveRecord::SchemaMigration Destroy (0.1ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = '20231107115131'[0m
  [1m[36mTRANSACTION (7.4ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateBasket (20231107115131)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE TABLE "basket_products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "user_id" integer, "product_id" integer, "amount" integer, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20231107115131') RETURNING "version"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Completed 200 OK in 325593ms (Views: 0.4ms | ActiveRecord: 0.6ms | Allocations: 18387)


Started GET "/users/1/baskets" for ::1 at 2023-11-07 13:12:13 +0100
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by BasketsController#index as */*
  Parameters: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "user_id"=>"1", "basket"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}}
DEPRECATION WARNING: `Rails.application.secrets` is deprecated in favor of `Rails.application.credentials` and will be removed in Rails 7.2. (called from <class:JwtService> at /home/topper/rails_test/products_api/app/services/jwt_service.rb:2)
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:21:in `from_jwt'
Completed 200 OK in 90821ms (Views: 0.2ms | ActiveRecord: 0.4ms | Allocations: 71634)


Started GET "/users/1/baskets" for ::1 at 2023-11-07 13:13:46 +0100
Processing by BasketsController#index as */*
  Parameters: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "user_id"=>"1", "basket"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}}
DEPRECATION WARNING: `Rails.application.secrets` is deprecated in favor of `Rails.application.credentials` and will be removed in Rails 7.2. (called from <class:JwtService> at /home/topper/rails_test/products_api/app/services/jwt_service.rb:2)
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:21:in `from_jwt'
Completed 200 OK in 27619ms (Views: 0.2ms | ActiveRecord: 1.2ms | Allocations: 11673)


Started GET "/users/1/baskets" for ::1 at 2023-11-07 13:14:15 +0100
Processing by BasketsController#index as */*
  Parameters: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "user_id"=>"1", "basket"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}}
DEPRECATION WARNING: `Rails.application.secrets` is deprecated in favor of `Rails.application.credentials` and will be removed in Rails 7.2. (called from <class:JwtService> at /home/topper/rails_test/products_api/app/services/jwt_service.rb:2)
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:21:in `from_jwt'
  [1m[36mBasketProduct Load (0.1ms)[0m  [1m[34mSELECT "basket_products".* FROM "basket_products" WHERE "basket_products"."user_id" = ? /* loading for inspect */ LIMIT ?[0m  [["user_id", 1], ["LIMIT", 11]]
  â†³ app/controllers/baskets_controller.rb:4:in `index'
Completed 200 OK in 117210ms (Views: 0.2ms | ActiveRecord: 1.6ms | Allocations: 15234)


Started GET "/users/1/baskets" for ::1 at 2023-11-07 13:16:15 +0100
Processing by BasketsController#index as */*
  Parameters: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "user_id"=>"1", "basket"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}}
DEPRECATION WARNING: `Rails.application.secrets` is deprecated in favor of `Rails.application.credentials` and will be removed in Rails 7.2. (called from <class:JwtService> at /home/topper/rails_test/products_api/app/services/jwt_service.rb:2)
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:21:in `from_jwt'
  [1m[36mProduct Load (0.1ms)[0m  [1m[34mSELECT "products".* FROM "products" INNER JOIN "basket_products" ON "products"."id" = "basket_products"."product_id" WHERE "basket_products"."user_id" = ? /* loading for inspect */ LIMIT ?[0m  [["user_id", 1], ["LIMIT", 11]]
  â†³ app/controllers/baskets_controller.rb:4:in `index'
Completed 200 OK in 20776ms (Views: 0.2ms | ActiveRecord: 1.6ms | Allocations: 17128)


Started GET "/users/1/baskets" for ::1 at 2023-11-07 13:17:14 +0100
Processing by BasketsController#index as */*
  Parameters: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "user_id"=>"1", "basket"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}}
Completed 200 OK in 169095ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 4887)


Started GET "/users/1/baskets" for ::1 at 2023-11-07 13:20:31 +0100
Processing by BasketsController#index as */*
  Parameters: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "user_id"=>"1", "basket"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}}
DEPRECATION WARNING: `Rails.application.secrets` is deprecated in favor of `Rails.application.credentials` and will be removed in Rails 7.2. (called from <class:JwtService> at /home/topper/rails_test/products_api/app/services/jwt_service.rb:2)
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:21:in `from_jwt'
Filter chain halted as :authorize rendered or redirected
Completed 401 Unauthorized in 9ms (Views: 0.1ms | ActiveRecord: 1.6ms | Allocations: 5644)


Started GET "/users/1/baskets" for ::1 at 2023-11-07 13:20:39 +0100
Processing by BasketsController#index as */*
  Parameters: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "user_id"=>"1", "basket"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:21:in `from_jwt'
Filter chain halted as :authorize rendered or redirected
Completed 401 Unauthorized in 1ms (Views: 0.1ms | ActiveRecord: 0.1ms | Allocations: 524)


Started GET "/users/1/baskets" for ::1 at 2023-11-07 13:20:40 +0100
Processing by BasketsController#index as */*
  Parameters: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "user_id"=>"1", "basket"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:21:in `from_jwt'
Filter chain halted as :authorize rendered or redirected
Completed 401 Unauthorized in 1ms (Views: 0.1ms | ActiveRecord: 0.1ms | Allocations: 521)


Started GET "/users/1/baskets" for ::1 at 2023-11-07 13:20:49 +0100
Processing by BasketsController#index as */*
  Parameters: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "user_id"=>"1", "basket"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}}
DEPRECATION WARNING: `Rails.application.secrets` is deprecated in favor of `Rails.application.credentials` and will be removed in Rails 7.2. (called from <class:JwtService> at /home/topper/rails_test/products_api/app/services/jwt_service.rb:2)
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:21:in `from_jwt'
Filter chain halted as :authorize rendered or redirected
Completed 401 Unauthorized in 34452ms (Views: 0.2ms | ActiveRecord: 1.1ms | Allocations: 11034)


Started GET "/users/1/baskets" for ::1 at 2023-11-07 13:21:50 +0100
Processing by BasketsController#index as */*
  Parameters: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "user_id"=>"1", "basket"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}}
DEPRECATION WARNING: `Rails.application.secrets` is deprecated in favor of `Rails.application.credentials` and will be removed in Rails 7.2. (called from <class:JwtService> at /home/topper/rails_test/products_api/app/services/jwt_service.rb:2)
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:21:in `from_jwt'
  [1m[36mProduct Load (0.1ms)[0m  [1m[34mSELECT "products".* FROM "products" INNER JOIN "basket_products" ON "products"."id" = "basket_products"."product_id" WHERE "basket_products"."user_id" = ?[0m  [["user_id", 1]]
  â†³ app/controllers/baskets_controller.rb:5:in `index'
Completed 200 OK in 16ms (Views: 2.5ms | ActiveRecord: 1.5ms | Allocations: 10040)


Started POST "/sessions" for ::1 at 2023-11-07 13:22:08 +0100
Processing by SessionsController#create as */*
  Parameters: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "session"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}}
[31mUnpermitted parameters: :full_name, :session. Context: { controller: SessionsController, action: create, request: #<ActionDispatch::Request:0x00007fd58cd0a480>, params: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "controller"=>"sessions", "action"=>"create", "session"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}} }[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "admin@test.dk"], ["LIMIT", 1]]
  â†³ app/controllers/sessions_controller.rb:3:in `create'
[31mUnpermitted parameters: :full_name, :session. Context: { controller: SessionsController, action: create, request: #<ActionDispatch::Request:0x00007fd58cd0a480>, params: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "controller"=>"sessions", "action"=>"create", "session"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}} }[0m
Completed 200 OK in 169ms (Views: 0.1ms | ActiveRecord: 0.1ms | Allocations: 1230)


Started GET "/users/1/baskets" for ::1 at 2023-11-07 13:22:25 +0100
Processing by BasketsController#index as */*
  Parameters: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "user_id"=>"1", "basket"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:21:in `from_jwt'
  [1m[36mProduct Load (0.0ms)[0m  [1m[34mSELECT "products".* FROM "products" INNER JOIN "basket_products" ON "products"."id" = "basket_products"."product_id" WHERE "basket_products"."user_id" = ?[0m  [["user_id", 1]]
  â†³ app/controllers/baskets_controller.rb:5:in `index'
Completed 200 OK in 2ms (Views: 0.9ms | ActiveRecord: 0.1ms | Allocations: 1331)


Started GET "/users/1/baskets" for ::1 at 2023-11-07 13:24:58 +0100
Processing by BasketsController#index as */*
  Parameters: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "user_id"=>"1", "basket"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:21:in `from_jwt'
  [1m[36mProduct Load (0.1ms)[0m  [1m[34mSELECT "products".* FROM "products" INNER JOIN "basket_products" ON "products"."id" = "basket_products"."product_id" WHERE "basket_products"."user_id" = ?[0m  [["user_id", 1]]
  â†³ app/controllers/baskets_controller.rb:5:in `index'
Completed 200 OK in 8ms (Views: 3.5ms | ActiveRecord: 0.4ms | Allocations: 1332)


Started GET "/users/1/baskets" for ::1 at 2023-11-07 23:40:36 +0100
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  
SyntaxError (/home/topper/rails_test/products_api/app/controllers/baskets_controller.rb:6: syntax error, unexpected `end', expecting '}'
    end
    ^~~
):
  
app/controllers/baskets_controller.rb:6: syntax error, unexpected `end', expecting '}'
Started GET "/users/1/baskets" for ::1 at 2023-11-07 23:41:02 +0100
Processing by BasketsController#index as */*
  Parameters: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "user_id"=>"1", "basket"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}}
DEPRECATION WARNING: `Rails.application.secrets` is deprecated in favor of `Rails.application.credentials` and will be removed in Rails 7.2. (called from <class:JwtService> at /home/topper/rails_test/products_api/app/services/jwt_service.rb:2)
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:21:in `from_jwt'
  [1m[36mBasketProduct Load (0.0ms)[0m  [1m[34mSELECT "basket_products".* FROM "basket_products" WHERE "basket_products"."user_id" = ?[0m  [["user_id", 1]]
  â†³ app/controllers/baskets_controller.rb:5:in `map'
Completed 200 OK in 78ms (Views: 0.3ms | ActiveRecord: 2.0ms | Allocations: 25624)


  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "basket_products"[0m
  [1m[35m (6.4ms)[0m  [1m[35mCREATE TABLE "basket_products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "user_id" integer, "product_id" integer, "amount" integer, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "description" text, "price" integer, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "full_name" varchar, "email" varchar, "password_digest" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_users_on_email" ON "users" ("email")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20231107115131)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20231106215035),
(20231106120630);[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.3ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'development', '2023-11-07 22:45:50.304766', '2023-11-07 22:45:50.304771') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('schema_sha1', '297de8a87614bb2f3fc342f8f679a7ec958ff91d', '2023-11-07 22:45:50.307954', '2023-11-07 22:45:50.307957') RETURNING "key"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "basket_products"[0m
  [1m[35m (4.9ms)[0m  [1m[35mCREATE TABLE "basket_products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "user_id" integer, "product_id" integer, "amount" integer, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "description" text, "price" integer, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "full_name" varchar, "email" varchar, "password_digest" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_users_on_email" ON "users" ("email")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20231107115131)[0m
  [1m[35m (0.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20231106215035),
(20231106120630);[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'development', '2023-11-07 22:45:50.334444', '2023-11-07 22:45:50.334446') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Update (0.0ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = 'test', "updated_at" = '2023-11-07 22:45:50.335433' WHERE "ar_internal_metadata"."key" = 'environment'[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('schema_sha1', '297de8a87614bb2f3fc342f8f679a7ec958ff91d', '2023-11-07 22:45:50.336359', '2023-11-07 22:45:50.336360') RETURNING "key"[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mUser Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "admin@test.dk"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("full_name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["full_name", "Super Admin"], ["email", "admin@test.dk"], ["password_digest", "[FILTERED]"], ["created_at", "2023-11-07 22:45:50.547658"], ["updated_at", "2023-11-07 22:45:50.547658"]]
  [1m[36mTRANSACTION (5.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mProduct Create (0.7ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Shoe"], ["description", "A very nice shoe in hight quality"], ["price", 60], ["created_at", "2023-11-07 22:45:50.569759"], ["updated_at", "2023-11-07 22:45:50.569759"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mProduct Create (0.6ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Jacket"], ["description", "A very nice jacket in hight quality"], ["price", 120], ["created_at", "2023-11-07 22:45:50.575907"], ["updated_at", "2023-11-07 22:45:50.575907"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mBasketProduct Create (0.1ms)[0m  [1m[32mINSERT INTO "basket_products" ("user_id", "product_id", "amount", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["user_id", 1], ["product_id", 1], ["amount", nil], ["created_at", "2023-11-07 22:45:50.602776"], ["updated_at", "2023-11-07 22:45:50.602776"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mBasketProduct Create (0.1ms)[0m  [1m[32mINSERT INTO "basket_products" ("user_id", "product_id", "amount", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["user_id", 1], ["product_id", 2], ["amount", nil], ["created_at", "2023-11-07 22:45:50.606215"], ["updated_at", "2023-11-07 22:45:50.606215"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mUser Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "admin@test.dk"], ["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mUser Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "admin@test.dk"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mProduct Create (1.0ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Shoe"], ["description", "A very nice shoe in hight quality"], ["price", 60], ["created_at", "2023-11-07 22:45:53.966095"], ["updated_at", "2023-11-07 22:45:53.966095"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mProduct Create (0.7ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Jacket"], ["description", "A very nice jacket in hight quality"], ["price", 120], ["created_at", "2023-11-07 22:45:53.969333"], ["updated_at", "2023-11-07 22:45:53.969333"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mUser Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "admin@test.dk"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" /* loading for inspect */ LIMIT ?[0m  [["LIMIT", 11]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mUser Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "admin@test.dk"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mProduct Create (0.8ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Shoe"], ["description", "A very nice shoe in hight quality"], ["price", 60], ["created_at", "2023-11-07 22:46:17.087244"], ["updated_at", "2023-11-07 22:46:17.087244"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mProduct Create (0.9ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Jacket"], ["description", "A very nice jacket in hight quality"], ["price", 120], ["created_at", "2023-11-07 22:46:17.089983"], ["updated_at", "2023-11-07 22:46:17.089983"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mUser Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "admin@test.dk"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "basket_products"[0m
  [1m[35m (4.9ms)[0m  [1m[35mCREATE TABLE "basket_products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "user_id" integer, "product_id" integer, "amount" integer, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "description" text, "price" integer, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "full_name" varchar, "email" varchar, "password_digest" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_users_on_email" ON "users" ("email")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20231107115131)[0m
  [1m[35m (0.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20231106215035),
(20231106120630);[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'development', '2023-11-07 22:46:26.995911', '2023-11-07 22:46:26.995914') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('schema_sha1', '297de8a87614bb2f3fc342f8f679a7ec958ff91d', '2023-11-07 22:46:26.998421', '2023-11-07 22:46:26.998423') RETURNING "key"[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "basket_products"[0m
  [1m[35m (6.3ms)[0m  [1m[35mCREATE TABLE "basket_products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "user_id" integer, "product_id" integer, "amount" integer, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "description" text, "price" integer, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "full_name" varchar, "email" varchar, "password_digest" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE INDEX "index_users_on_email" ON "users" ("email")[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20231107115131)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20231106215035),
(20231106120630);[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'development', '2023-11-07 22:46:27.039941', '2023-11-07 22:46:27.039945') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = 'test', "updated_at" = '2023-11-07 22:46:27.042220' WHERE "ar_internal_metadata"."key" = 'environment'[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('schema_sha1', '297de8a87614bb2f3fc342f8f679a7ec958ff91d', '2023-11-07 22:46:27.044453', '2023-11-07 22:46:27.044456') RETURNING "key"[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mUser Exists? (4.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "admin@test.dk"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("full_name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["full_name", "Super Admin"], ["email", "admin@test.dk"], ["password_digest", "[FILTERED]"], ["created_at", "2023-11-07 22:46:27.270230"], ["updated_at", "2023-11-07 22:46:27.270230"]]
  [1m[36mTRANSACTION (5.2ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mProduct Create (0.8ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Shoe"], ["description", "A very nice shoe in hight quality"], ["price", 60], ["created_at", "2023-11-07 22:46:27.293637"], ["updated_at", "2023-11-07 22:46:27.293637"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mProduct Create (0.9ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Jacket"], ["description", "A very nice jacket in hight quality"], ["price", 120], ["created_at", "2023-11-07 22:46:27.295985"], ["updated_at", "2023-11-07 22:46:27.295985"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mBasketProduct Create (0.1ms)[0m  [1m[32mINSERT INTO "basket_products" ("user_id", "product_id", "amount", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["user_id", 1], ["product_id", 1], ["amount", nil], ["created_at", "2023-11-07 22:46:27.321461"], ["updated_at", "2023-11-07 22:46:27.321461"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mBasketProduct Create (0.1ms)[0m  [1m[32mINSERT INTO "basket_products" ("user_id", "product_id", "amount", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["user_id", 1], ["product_id", 2], ["amount", nil], ["created_at", "2023-11-07 22:46:27.324901"], ["updated_at", "2023-11-07 22:46:27.324901"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mUser Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "admin@test.dk"], ["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mUser Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "admin@test.dk"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mProduct Create (0.9ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Shoe"], ["description", "A very nice shoe in hight quality"], ["price", 60], ["created_at", "2023-11-07 22:46:31.054397"], ["updated_at", "2023-11-07 22:46:31.054397"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mProduct Create (0.5ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Jacket"], ["description", "A very nice jacket in hight quality"], ["price", 120], ["created_at", "2023-11-07 22:46:31.057391"], ["updated_at", "2023-11-07 22:46:31.057391"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mUser Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "admin@test.dk"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (5.2ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'development', '2023-11-07 22:47:19.848845', '2023-11-07 22:47:19.848847') RETURNING "key"[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateUsersTable (20231106120630)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "full_name" varchar, "email" varchar, "password_digest" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_users_on_email" ON "users" ("email")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20231106120630') RETURNING "version"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mcommit transaction[0m
Migrating to CreateProducts (20231106215035)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "description" text, "price" integer, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20231106215035') RETURNING "version"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
Migrating to CreateBasket (20231107115131)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE TABLE "basket_products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "user_id" integer, "product_id" integer, "amount" integer, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20231107115131') RETURNING "version"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mUser Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "admin@test.dk"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("full_name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["full_name", "Super Admin"], ["email", "admin@test.dk"], ["password_digest", "[FILTERED]"], ["created_at", "2023-11-07 22:47:22.270424"], ["updated_at", "2023-11-07 22:47:22.270424"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mProduct Create (1.1ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Shoe"], ["description", "A very nice shoe in hight quality"], ["price", 60], ["created_at", "2023-11-07 22:47:22.286789"], ["updated_at", "2023-11-07 22:47:22.286789"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mProduct Create (0.7ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Jacket"], ["description", "A very nice jacket in hight quality"], ["price", 120], ["created_at", "2023-11-07 22:47:22.289652"], ["updated_at", "2023-11-07 22:47:22.289652"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mBasketProduct Create (0.1ms)[0m  [1m[32mINSERT INTO "basket_products" ("user_id", "product_id", "amount", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["user_id", 1], ["product_id", 1], ["amount", nil], ["created_at", "2023-11-07 22:47:22.314275"], ["updated_at", "2023-11-07 22:47:22.314275"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mBasketProduct Create (0.1ms)[0m  [1m[32mINSERT INTO "basket_products" ("user_id", "product_id", "amount", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["user_id", 1], ["product_id", 2], ["amount", nil], ["created_at", "2023-11-07 22:47:22.317821"], ["updated_at", "2023-11-07 22:47:22.317821"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mUser Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "admin@test.dk"], ["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
Started POST "/sessions" for ::1 at 2023-11-07 23:47:37 +0100
Processing by SessionsController#create as */*
  Parameters: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "session"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}}
[31mUnpermitted parameters: :full_name, :session. Context: { controller: SessionsController, action: create, request: #<ActionDispatch::Request:0x00007f2114fa6680>, params: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "controller"=>"sessions", "action"=>"create", "session"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}} }[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "admin@test.dk"], ["LIMIT", 1]]
  â†³ app/controllers/sessions_controller.rb:3:in `create'
[31mUnpermitted parameters: :full_name, :session. Context: { controller: SessionsController, action: create, request: #<ActionDispatch::Request:0x00007f2114fa6680>, params: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "controller"=>"sessions", "action"=>"create", "session"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}} }[0m
DEPRECATION WARNING: `Rails.application.secrets` is deprecated in favor of `Rails.application.credentials` and will be removed in Rails 7.2. (called from <class:JwtService> at /home/topper/rails_test/products_api/app/services/jwt_service.rb:2)
Completed 200 OK in 174ms (Views: 0.1ms | ActiveRecord: 1.0ms | Allocations: 5818)


Started GET "/users/1/baskets" for ::1 at 2023-11-07 23:47:57 +0100
Processing by BasketsController#index as */*
  Parameters: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "user_id"=>"1", "basket"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:21:in `from_jwt'
  [1m[36mBasketProduct Load (0.1ms)[0m  [1m[34mSELECT "basket_products".* FROM "basket_products" WHERE "basket_products"."user_id" = ?[0m  [["user_id", 1]]
  â†³ app/controllers/baskets_controller.rb:5:in `map'
  [1m[36mProduct Load (0.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/baskets_controller.rb:5:in `block in index'
  [1m[36mProduct Load (0.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/baskets_controller.rb:5:in `block in index'
Completed 200 OK in 33ms (Views: 0.3ms | ActiveRecord: 0.6ms | Allocations: 16094)


  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "basket_products"[0m
  [1m[35m (5.6ms)[0m  [1m[35mCREATE TABLE "basket_products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "user_id" integer, "product_id" integer, "amount" integer, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "description" text, "price" integer, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "full_name" varchar, "email" varchar, "password_digest" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_users_on_email" ON "users" ("email")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20231107115131)[0m
  [1m[35m (0.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20231106215035),
(20231106120630);[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'development', '2023-11-07 22:50:50.950955', '2023-11-07 22:50:50.950957') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('schema_sha1', '297de8a87614bb2f3fc342f8f679a7ec958ff91d', '2023-11-07 22:50:50.953680', '2023-11-07 22:50:50.953682') RETURNING "key"[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "basket_products"[0m
  [1m[35m (6.9ms)[0m  [1m[35mCREATE TABLE "basket_products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "user_id" integer, "product_id" integer, "amount" integer, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "description" text, "price" integer, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "full_name" varchar, "email" varchar, "password_digest" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_users_on_email" ON "users" ("email")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20231107115131)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20231106215035),
(20231106120630);[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'development', '2023-11-07 22:50:51.028184', '2023-11-07 22:50:51.028186') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = 'test', "updated_at" = '2023-11-07 22:50:51.029497' WHERE "ar_internal_metadata"."key" = 'environment'[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('schema_sha1', '297de8a87614bb2f3fc342f8f679a7ec958ff91d', '2023-11-07 22:50:51.030718', '2023-11-07 22:50:51.030720') RETURNING "key"[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mUser Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "admin@test.dk"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("full_name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["full_name", "Super Admin"], ["email", "admin@test.dk"], ["password_digest", "[FILTERED]"], ["created_at", "2023-11-07 22:50:51.246695"], ["updated_at", "2023-11-07 22:50:51.246695"]]
  [1m[36mTRANSACTION (5.6ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mProduct Create (0.7ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Shoe"], ["description", "A very nice shoe in hight quality"], ["price", 60], ["created_at", "2023-11-07 22:50:51.269753"], ["updated_at", "2023-11-07 22:50:51.269753"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mProduct Create (0.6ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Jacket"], ["description", "A very nice jacket in hight quality"], ["price", 120], ["created_at", "2023-11-07 22:50:51.271929"], ["updated_at", "2023-11-07 22:50:51.271929"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mBasketProduct Create (0.1ms)[0m  [1m[32mINSERT INTO "basket_products" ("user_id", "product_id", "amount", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["user_id", 1], ["product_id", 1], ["amount", nil], ["created_at", "2023-11-07 22:50:51.293579"], ["updated_at", "2023-11-07 22:50:51.293579"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "basket_products"[0m
  [1m[35m (4.6ms)[0m  [1m[35mCREATE TABLE "basket_products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "user_id" integer, "product_id" integer, "amount" integer, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "description" text, "price" integer, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "full_name" varchar, "email" varchar, "password_digest" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_users_on_email" ON "users" ("email")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20231107115131)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20231106215035),
(20231106120630);[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'development', '2023-11-07 22:51:14.471431', '2023-11-07 22:51:14.471434') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('schema_sha1', '297de8a87614bb2f3fc342f8f679a7ec958ff91d', '2023-11-07 22:51:14.475414', '2023-11-07 22:51:14.475416') RETURNING "key"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "basket_products"[0m
  [1m[35m (4.7ms)[0m  [1m[35mCREATE TABLE "basket_products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "user_id" integer, "product_id" integer, "amount" integer, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "description" text, "price" integer, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "full_name" varchar, "email" varchar, "password_digest" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_users_on_email" ON "users" ("email")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20231107115131)[0m
  [1m[35m (0.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20231106215035),
(20231106120630);[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'development', '2023-11-07 22:51:14.501564', '2023-11-07 22:51:14.501566') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Update (0.0ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = 'test', "updated_at" = '2023-11-07 22:51:14.502650' WHERE "ar_internal_metadata"."key" = 'environment'[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('schema_sha1', '297de8a87614bb2f3fc342f8f679a7ec958ff91d', '2023-11-07 22:51:14.503618', '2023-11-07 22:51:14.503619') RETURNING "key"[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mUser Exists? (5.0ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "admin@test.dk"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("full_name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["full_name", "Super Admin"], ["email", "admin@test.dk"], ["password_digest", "[FILTERED]"], ["created_at", "2023-11-07 22:51:14.732428"], ["updated_at", "2023-11-07 22:51:14.732428"]]
  [1m[36mTRANSACTION (6.1ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mProduct Create (0.7ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Shoe"], ["description", "A very nice shoe in hight quality"], ["price", 60], ["created_at", "2023-11-07 22:51:14.754986"], ["updated_at", "2023-11-07 22:51:14.754986"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mProduct Create (0.9ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Jacket"], ["description", "A very nice jacket in hight quality"], ["price", 120], ["created_at", "2023-11-07 22:51:14.757126"], ["updated_at", "2023-11-07 22:51:14.757126"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mBasketProduct Create (0.1ms)[0m  [1m[32mINSERT INTO "basket_products" ("user_id", "product_id", "amount", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["user_id", 1], ["product_id", 1], ["amount", nil], ["created_at", "2023-11-07 22:51:14.781463"], ["updated_at", "2023-11-07 22:51:14.781463"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[35m (6.3ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'development', '2023-11-07 22:52:02.907388', '2023-11-07 22:52:02.907391') RETURNING "key"[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateUsersTable (20231106120630)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "full_name" varchar, "email" varchar, "password_digest" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_users_on_email" ON "users" ("email")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20231106120630') RETURNING "version"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mcommit transaction[0m
Migrating to CreateProducts (20231106215035)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "description" text, "price" integer, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20231106215035') RETURNING "version"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
Migrating to CreateBasket (20231107115131)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE TABLE "basket_products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "user_id" integer, "product_id" integer, "amount" integer, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20231107115131') RETURNING "version"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mUser Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "admin@test.dk"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("full_name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["full_name", "Super Admin"], ["email", "admin@test.dk"], ["password_digest", "[FILTERED]"], ["created_at", "2023-11-07 22:52:04.998337"], ["updated_at", "2023-11-07 22:52:04.998337"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mProduct Create (0.9ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Shoe"], ["description", "A very nice shoe in hight quality"], ["price", 60], ["created_at", "2023-11-07 22:52:05.013321"], ["updated_at", "2023-11-07 22:52:05.013321"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mProduct Create (0.7ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Jacket"], ["description", "A very nice jacket in hight quality"], ["price", 120], ["created_at", "2023-11-07 22:52:05.015822"], ["updated_at", "2023-11-07 22:52:05.015822"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mBasketProduct Create (0.1ms)[0m  [1m[32mINSERT INTO "basket_products" ("user_id", "product_id", "amount", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["user_id", 1], ["product_id", 1], ["amount", nil], ["created_at", "2023-11-07 22:52:05.039418"], ["updated_at", "2023-11-07 22:52:05.039418"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mBasketProduct Load (0.1ms)[0m  [1m[34mSELECT "basket_products".* FROM "basket_products" WHERE "basket_products"."product_id" = ? LIMIT ?[0m  [["product_id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mBasketProduct Update (0.6ms)[0m  [1m[33mUPDATE "basket_products" SET "amount" = ?, "updated_at" = ? WHERE "basket_products"."id" = ?[0m  [["amount", 2], ["updated_at", "2023-11-07 22:52:05.041749"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mBasketProduct Create (0.1ms)[0m  [1m[32mINSERT INTO "basket_products" ("user_id", "product_id", "amount", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["user_id", 1], ["product_id", 2], ["amount", nil], ["created_at", "2023-11-07 22:52:05.045444"], ["updated_at", "2023-11-07 22:52:05.045444"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mBasketProduct Load (0.0ms)[0m  [1m[34mSELECT "basket_products".* FROM "basket_products" WHERE "basket_products"."product_id" = ? LIMIT ?[0m  [["product_id", 2], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mBasketProduct Update (0.6ms)[0m  [1m[33mUPDATE "basket_products" SET "amount" = ?, "updated_at" = ? WHERE "basket_products"."id" = ?[0m  [["amount", 0], ["updated_at", "2023-11-07 22:52:05.047191"], ["id", 2]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mUser Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "admin@test.dk"], ["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
Started GET "/users/1/baskets" for ::1 at 2023-11-07 23:52:10 +0100
Processing by BasketsController#index as */*
  Parameters: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "user_id"=>"1", "basket"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}}
DEPRECATION WARNING: `Rails.application.secrets` is deprecated in favor of `Rails.application.credentials` and will be removed in Rails 7.2. (called from <class:JwtService> at /home/topper/rails_test/products_api/app/services/jwt_service.rb:2)
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:21:in `from_jwt'
  [1m[36mBasketProduct Load (0.1ms)[0m  [1m[34mSELECT "basket_products".* FROM "basket_products" WHERE "basket_products"."user_id" = ?[0m  [["user_id", 1]]
  â†³ app/controllers/baskets_controller.rb:5:in `map'
  [1m[36mProduct Load (0.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/baskets_controller.rb:5:in `block in index'
  [1m[36mProduct Load (0.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/baskets_controller.rb:5:in `block in index'
Completed 200 OK in 23ms (Views: 0.5ms | ActiveRecord: 1.9ms | Allocations: 15532)


Started GET "/users/1/baskets" for ::1 at 2023-11-07 23:53:37 +0100
Processing by BasketsController#index as */*
  Parameters: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "user_id"=>"1", "basket"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}}
DEPRECATION WARNING: `Rails.application.secrets` is deprecated in favor of `Rails.application.credentials` and will be removed in Rails 7.2. (called from <class:JwtService> at /home/topper/rails_test/products_api/app/services/jwt_service.rb:2)
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:21:in `from_jwt'
Completed 500 Internal Server Error in 13ms (ActiveRecord: 1.2ms | Allocations: 7547)


  
TypeError (wrong argument type Symbol (expected Module)):
  
app/controllers/baskets_controller.rb:5:in `index'
Started GET "/users/1/baskets" for ::1 at 2023-11-07 23:53:48 +0100
Processing by BasketsController#index as */*
  Parameters: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "user_id"=>"1", "basket"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}}
DEPRECATION WARNING: `Rails.application.secrets` is deprecated in favor of `Rails.application.credentials` and will be removed in Rails 7.2. (called from <class:JwtService> at /home/topper/rails_test/products_api/app/services/jwt_service.rb:2)
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:21:in `from_jwt'
  [1m[36mBasketProduct Load (0.1ms)[0m  [1m[34mSELECT "basket_products".* FROM "basket_products" WHERE "basket_products"."user_id" = ? AND "basket_products"."amount" != ?[0m  [["user_id", 1], ["amount", 0]]
  â†³ app/controllers/baskets_controller.rb:6:in `map'
  [1m[36mProduct Load (0.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/baskets_controller.rb:6:in `block in index'
Completed 200 OK in 20ms (Views: 0.3ms | ActiveRecord: 1.6ms | Allocations: 15052)


Started GET "/users/1/baskets" for ::1 at 2023-11-07 23:53:56 +0100
Processing by BasketsController#index as */*
  Parameters: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "user_id"=>"1", "basket"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}}
DEPRECATION WARNING: `Rails.application.secrets` is deprecated in favor of `Rails.application.credentials` and will be removed in Rails 7.2. (called from <class:JwtService> at /home/topper/rails_test/products_api/app/services/jwt_service.rb:2)
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:21:in `from_jwt'
  [1m[36mBasketProduct Load (0.1ms)[0m  [1m[34mSELECT "basket_products".* FROM "basket_products" WHERE "basket_products"."user_id" = ? AND "basket_products"."amount" != ?[0m  [["user_id", 1], ["amount", 0]]
  â†³ app/controllers/baskets_controller.rb:6:in `map'
  [1m[36mProduct Load (0.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = ?[0m  [["id", 1]]
  â†³ app/controllers/baskets_controller.rb:6:in `map'
Completed 200 OK in 31ms (Views: 0.2ms | ActiveRecord: 1.6ms | Allocations: 17928)


Started GET "/users/1/baskets" for ::1 at 2023-11-07 23:54:25 +0100
Processing by BasketsController#index as */*
  Parameters: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "user_id"=>"1", "basket"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}}
DEPRECATION WARNING: `Rails.application.secrets` is deprecated in favor of `Rails.application.credentials` and will be removed in Rails 7.2. (called from <class:JwtService> at /home/topper/rails_test/products_api/app/services/jwt_service.rb:2)
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:21:in `from_jwt'
  [1m[36mBasketProduct Load (0.1ms)[0m  [1m[34mSELECT "basket_products".* FROM "basket_products" WHERE "basket_products"."user_id" = ? AND "basket_products"."amount" != ?[0m  [["user_id", 1], ["amount", 0]]
  â†³ app/controllers/baskets_controller.rb:6:in `map'
  [1m[36mProduct Load (0.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = ?[0m  [["id", 1]]
  â†³ app/controllers/baskets_controller.rb:6:in `map'
Completed 200 OK in 21ms (Views: 0.2ms | ActiveRecord: 1.6ms | Allocations: 15020)


Started GET "/users/1/baskets" for ::1 at 2023-11-08 12:33:29 +0100
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by BasketsController#index as */*
  Parameters: {"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin", "user_id"=>"1", "basket"=>{"email"=>"admin@test.dk", "password"=>"[FILTERED]", "full_name"=>"Super Admin"}}
DEPRECATION WARNING: `Rails.application.secrets` is deprecated in favor of `Rails.application.credentials` and will be removed in Rails 7.2. (called from <class:JwtService> at /home/topper/rails_test/products_api/app/services/jwt_service.rb:2)
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:21:in `from_jwt'
  [1m[36mBasketProduct Load (0.0ms)[0m  [1m[34mSELECT "basket_products".* FROM "basket_products" WHERE "basket_products"."user_id" = ? AND "basket_products"."amount" != ?[0m  [["user_id", 1], ["amount", 0]]
  â†³ app/controllers/baskets_controller.rb:6:in `map'
  [1m[36mProduct Load (0.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = ?[0m  [["id", 1]]
  â†³ app/controllers/baskets_controller.rb:6:in `map'
Completed 200 OK in 118ms (Views: 0.5ms | ActiveRecord: 0.9ms | Allocations: 39377)


Started PATCH "/users/1/baskets" for ::1 at 2023-11-08 12:34:03 +0100
  
ActionController::RoutingError (No route matches [PATCH] "/users/1/baskets"):
  
Started PUT "/users/1/baskets" for ::1 at 2023-11-08 12:34:08 +0100
  
ActionController::RoutingError (No route matches [PUT] "/users/1/baskets"):
  
Started PUT "/users/1/baskets" for ::1 at 2023-11-08 12:35:08 +0100
Processing by BasketsController#update as */*
  Parameters: {"product_id"=>2, "amount"=>1, "user_id"=>"1", "basket"=>{"product_id"=>2, "amount"=>1}}
DEPRECATION WARNING: `Rails.application.secrets` is deprecated in favor of `Rails.application.credentials` and will be removed in Rails 7.2. (called from <class:JwtService> at /home/topper/rails_test/products_api/app/services/jwt_service.rb:2)
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:21:in `from_jwt'
  [1m[36mProduct Load (0.2ms)[0m  [1m[34mSELECT "products".* FROM "products" INNER JOIN "basket_products" ON "products"."id" = "basket_products"."product_id" WHERE "basket_products"."user_id" = ? AND "products"."product_id" = ? LIMIT ?[0m  [["user_id", 1], ["product_id", 2], ["LIMIT", 1]]
  â†³ app/controllers/baskets_controller.rb:10:in `update'
Completed 500 Internal Server Error in 20ms (ActiveRecord: 1.8ms | Allocations: 10708)


  
ActiveRecord::StatementInvalid (SQLite3::SQLException: no such column: products.product_id):
  
Started PUT "/users/1/baskets" for ::1 at 2023-11-08 12:36:34 +0100
Processing by BasketsController#update as */*
  Parameters: {"product_id"=>2, "amount"=>1, "user_id"=>"1", "basket"=>{"product_id"=>2, "amount"=>1}}
DEPRECATION WARNING: `Rails.application.secrets` is deprecated in favor of `Rails.application.credentials` and will be removed in Rails 7.2. (called from <class:JwtService> at /home/topper/rails_test/products_api/app/services/jwt_service.rb:2)
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:21:in `from_jwt'
  [1m[36mBasketProduct Load (0.1ms)[0m  [1m[34mSELECT "basket_products".* FROM "basket_products" WHERE "basket_products"."user_id" = ? AND "basket_products"."product_id" = ? LIMIT ?[0m  [["user_id", 1], ["product_id", 2], ["LIMIT", 1]]
  â†³ app/controllers/baskets_controller.rb:10:in `update'
Completed 500 Internal Server Error in 13ms (ActiveRecord: 1.6ms | Allocations: 10193)


  
NameError (undefined local variable or method `existing_product' for #<BasketsController:0x0000000000fe10>):
  
app/controllers/baskets_controller.rb:14:in `update'
Started PUT "/users/1/baskets" for ::1 at 2023-11-08 12:36:44 +0100
Processing by BasketsController#update as */*
  Parameters: {"product_id"=>2, "amount"=>1, "user_id"=>"1", "basket"=>{"product_id"=>2, "amount"=>1}}
DEPRECATION WARNING: `Rails.application.secrets` is deprecated in favor of `Rails.application.credentials` and will be removed in Rails 7.2. (called from <class:JwtService> at /home/topper/rails_test/products_api/app/services/jwt_service.rb:2)
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:21:in `from_jwt'
  [1m[36mBasketProduct Load (0.1ms)[0m  [1m[34mSELECT "basket_products".* FROM "basket_products" WHERE "basket_products"."user_id" = ? AND "basket_products"."product_id" = ? LIMIT ?[0m  [["user_id", 1], ["product_id", 2], ["LIMIT", 1]]
  â†³ app/controllers/baskets_controller.rb:10:in `update'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/controllers/baskets_controller.rb:15:in `update'
  [1m[36mBasketProduct Update (0.6ms)[0m  [1m[33mUPDATE "basket_products" SET "amount" = ?, "updated_at" = ? WHERE "basket_products"."id" = ?[0m  [["amount", 1], ["updated_at", "2023-11-08 11:36:44.750759"], ["id", 2]]
  â†³ app/controllers/baskets_controller.rb:15:in `update'
  [1m[36mTRANSACTION (4.9ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/controllers/baskets_controller.rb:15:in `update'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/baskets_controller.rb:18:in `update'
  [1m[36mProduct Load (0.1ms)[0m  [1m[34mSELECT "products".* FROM "products" INNER JOIN "basket_products" ON "products"."id" = "basket_products"."product_id" WHERE "basket_products"."user_id" = ?[0m  [["user_id", 1]]
  â†³ app/controllers/baskets_controller.rb:19:in `update'
Completed 200 OK in 28ms (Views: 3.9ms | ActiveRecord: 7.2ms | Allocations: 18389)


Started PUT "/users/1/baskets" for ::1 at 2023-11-08 12:37:21 +0100
Processing by BasketsController#update as */*
  Parameters: {"product_id"=>2, "amount"=>2, "user_id"=>"1", "basket"=>{"product_id"=>2, "amount"=>2}}
DEPRECATION WARNING: `Rails.application.secrets` is deprecated in favor of `Rails.application.credentials` and will be removed in Rails 7.2. (called from <class:JwtService> at /home/topper/rails_test/products_api/app/services/jwt_service.rb:2)
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:21:in `from_jwt'
  [1m[36mBasketProduct Load (0.1ms)[0m  [1m[34mSELECT "basket_products".* FROM "basket_products" WHERE "basket_products"."user_id" = ? AND "basket_products"."product_id" = ? LIMIT ?[0m  [["user_id", 1], ["product_id", 2], ["LIMIT", 1]]
  â†³ app/controllers/baskets_controller.rb:10:in `update'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/controllers/baskets_controller.rb:15:in `update'
  [1m[36mBasketProduct Update (0.5ms)[0m  [1m[33mUPDATE "basket_products" SET "amount" = ?, "updated_at" = ? WHERE "basket_products"."id" = ?[0m  [["amount", 2], ["updated_at", "2023-11-08 11:37:21.196903"], ["id", 2]]
  â†³ app/controllers/baskets_controller.rb:15:in `update'
  [1m[36mTRANSACTION (4.7ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/controllers/baskets_controller.rb:15:in `update'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/baskets_controller.rb:18:in `update'
  [1m[36mBasketProduct Load (0.1ms)[0m  [1m[34mSELECT "basket_products".* FROM "basket_products" WHERE "basket_products"."user_id" = ? AND "basket_products"."amount" != ?[0m  [["user_id", 1], ["amount", 0]]
  â†³ app/controllers/baskets_controller.rb:20:in `map'
  [1m[36mProduct Load (0.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" IN (?, ?)[0m  [["id", 1], ["id", 2]]
  â†³ app/controllers/baskets_controller.rb:20:in `map'
Completed 200 OK in 30ms (Views: 0.3ms | ActiveRecord: 7.2ms | Allocations: 18013)


Started PUT "/users/1/baskets" for ::1 at 2023-11-08 12:37:32 +0100
Processing by BasketsController#update as */*
  Parameters: {"product_id"=>1, "amount"=>3, "user_id"=>"1", "basket"=>{"product_id"=>1, "amount"=>3}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:21:in `from_jwt'
  [1m[36mBasketProduct Load (0.0ms)[0m  [1m[34mSELECT "basket_products".* FROM "basket_products" WHERE "basket_products"."user_id" = ? AND "basket_products"."product_id" = ? LIMIT ?[0m  [["user_id", 1], ["product_id", 1], ["LIMIT", 1]]
  â†³ app/controllers/baskets_controller.rb:10:in `update'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/controllers/baskets_controller.rb:15:in `update'
  [1m[36mBasketProduct Update (0.5ms)[0m  [1m[33mUPDATE "basket_products" SET "amount" = ?, "updated_at" = ? WHERE "basket_products"."id" = ?[0m  [["amount", 3], ["updated_at", "2023-11-08 11:37:32.185162"], ["id", 1]]
  â†³ app/controllers/baskets_controller.rb:15:in `update'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/controllers/baskets_controller.rb:15:in `update'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/baskets_controller.rb:18:in `update'
  [1m[36mBasketProduct Load (0.0ms)[0m  [1m[34mSELECT "basket_products".* FROM "basket_products" WHERE "basket_products"."user_id" = ? AND "basket_products"."amount" != ?[0m  [["user_id", 1], ["amount", 0]]
  â†³ app/controllers/baskets_controller.rb:20:in `map'
  [1m[36mProduct Load (0.2ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" IN (?, ?)[0m  [["id", 1], ["id", 2]]
  â†³ app/controllers/baskets_controller.rb:20:in `map'
Completed 200 OK in 7ms (Views: 0.2ms | ActiveRecord: 0.9ms | Allocations: 4591)


Started GET "/users/1/baskets" for ::1 at 2023-11-08 12:37:40 +0100
  
ActionController::RoutingError (No route matches [GET] "/users/1/baskets"):
  
Started GET "/users/1/baskets" for ::1 at 2023-11-08 12:38:09 +0100
Processing by BasketsController#show as */*
  Parameters: {"product_id"=>1, "amount"=>3, "user_id"=>"1", "basket"=>{"product_id"=>1, "amount"=>3}}
DEPRECATION WARNING: `Rails.application.secrets` is deprecated in favor of `Rails.application.credentials` and will be removed in Rails 7.2. (called from <class:JwtService> at /home/topper/rails_test/products_api/app/services/jwt_service.rb:2)
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:21:in `from_jwt'
  [1m[36mBasketProduct Load (0.0ms)[0m  [1m[34mSELECT "basket_products".* FROM "basket_products" WHERE "basket_products"."user_id" = ? AND "basket_products"."amount" != ?[0m  [["user_id", 1], ["amount", 0]]
  â†³ app/controllers/baskets_controller.rb:6:in `map'
  [1m[36mProduct Load (0.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" IN (?, ?)[0m  [["id", 1], ["id", 2]]
  â†³ app/controllers/baskets_controller.rb:6:in `map'
Completed 200 OK in 20ms (Views: 0.3ms | ActiveRecord: 1.5ms | Allocations: 15107)


  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateOrders (20231110093551)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "orders" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "ordered_products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "order_id" integer, "product_id" integer, "baught_price" integer, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20231110093551') RETURNING "version"[0m
  [1m[36mTRANSACTION (5.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateOrders (20231110093551)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (1.0ms)[0m  [1m[35mDROP TABLE "ordered_products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE "orders"[0m
  [1m[36mActiveRecord::SchemaMigration Destroy (0.0ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = '20231110093551'[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateOrders (20231110093551)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "orders" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "user_id" integer, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "ordered_products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "order_id" integer, "product_id" integer, "baught_price" integer, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20231110093551') RETURNING "version"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started GET "/users/1/orders" for ::1 at 2023-11-10 10:47:35 +0100
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by OrdersController#index as */*
  Parameters: {"product_id"=>1, "amount"=>3, "user_id"=>"1", "order"=>{}}
DEPRECATION WARNING: `Rails.application.secrets` is deprecated in favor of `Rails.application.credentials` and will be removed in Rails 7.2. (called from <class:JwtService> at /home/topper/rails_test/products_api/app/services/jwt_service.rb:2)
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:22:in `from_jwt'
  [1m[36mOrder Load (0.1ms)[0m  [1m[34mSELECT "orders".* FROM "orders" WHERE "orders"."user_id" = ?[0m  [["user_id", 1]]
  â†³ app/controllers/application_controller.rb:22:in `success_response'
Completed 200 OK in 48ms (Views: 2.4ms | ActiveRecord: 0.7ms | Allocations: 18700)


Started GET "/users/1/orders" for ::1 at 2023-11-10 10:47:43 +0100
Processing by OrdersController#index as */*
  Parameters: {"product_id"=>1, "amount"=>3, "user_id"=>"1", "order"=>{}}
Filter chain halted as :authorize rendered or redirected
Completed 401 Unauthorized in 0ms (Views: 0.1ms | ActiveRecord: 0.0ms | Allocations: 113)


Started GET "/users/1/orders" for ::1 at 2023-11-10 10:47:46 +0100
Processing by OrdersController#index as */*
  Parameters: {"product_id"=>1, "amount"=>3, "user_id"=>"1", "order"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:22:in `from_jwt'
  [1m[36mOrder Load (0.0ms)[0m  [1m[34mSELECT "orders".* FROM "orders" WHERE "orders"."user_id" = ?[0m  [["user_id", 1]]
  â†³ app/controllers/application_controller.rb:22:in `success_response'
Completed 200 OK in 3ms (Views: 1.1ms | ActiveRecord: 0.1ms | Allocations: 1149)


Started POST "/users/1/orders" for ::1 at 2023-11-10 10:47:59 +0100
Processing by OrdersController#create as */*
  Parameters: {"user_id"=>"1"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:22:in `from_jwt'
Completed 500 Internal Server Error in 10ms (ActiveRecord: 0.1ms | Allocations: 3104)


  
NoMethodError (undefined method `create' for nil:NilClass):
  
app/controllers/orders_controller.rb:9:in `create'
Started POST "/users/1/orders" for ::1 at 2023-11-10 10:48:08 +0100
Processing by OrdersController#create as */*
  Parameters: {"user_id"=>"1"}
DEPRECATION WARNING: `Rails.application.secrets` is deprecated in favor of `Rails.application.credentials` and will be removed in Rails 7.2. (called from <class:JwtService> at /home/topper/rails_test/products_api/app/services/jwt_service.rb:2)
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:22:in `from_jwt'
  [1m[36mProduct Load (0.1ms)[0m  [1m[34mSELECT "products".* FROM "products" INNER JOIN "basket_products" ON "products"."id" = "basket_products"."product_id" WHERE "basket_products"."user_id" = ?[0m  [["user_id", 1]]
  â†³ app/controllers/orders_controller.rb:9:in `create'
Completed 500 Internal Server Error in 34ms (ActiveRecord: 1.6ms | Allocations: 21261)


  
ActiveRecord::AssociationTypeMismatch (OrderedProduct(#26820) expected, got #<Product id: 1, name: "Shoe", description: "A very nice shoe in hight quality", price: 60, created_at: "2023-11-07 22:52:05.013321000 +0000", updated_at: "2023-11-07 22:52:05.013321000 +0000"> which is an instance of Product(#26800)):
  
app/controllers/orders_controller.rb:9:in `create'
Started POST "/users/1/orders" for ::1 at 2023-11-10 10:51:21 +0100
  
SyntaxError (/home/topper/rails_test/products_api/app/controllers/orders_controller.rb:9: syntax error, unexpected '}', expecting ')'
...rder.create(user_id: @user.id })
...                              ^
/home/topper/rails_test/products_api/app/controllers/orders_controller.rb:10: syntax error, unexpected '}', expecting '}'
...d_product(order_id: order_id) }
...                              ^
):
  
app/controllers/orders_controller.rb:9: syntax error, unexpected '}', expecting ')'
app/controllers/orders_controller.rb:10: syntax error, unexpected '}', expecting '}'
Started POST "/users/1/orders" for ::1 at 2023-11-10 10:52:01 +0100
Processing by OrdersController#create as */*
  Parameters: {"user_id"=>"1"}
DEPRECATION WARNING: `Rails.application.secrets` is deprecated in favor of `Rails.application.credentials` and will be removed in Rails 7.2. (called from <class:JwtService> at /home/topper/rails_test/products_api/app/services/jwt_service.rb:2)
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:22:in `from_jwt'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/orders_controller.rb:9:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/controllers/orders_controller.rb:9:in `create'
  [1m[36mOrder Create (0.7ms)[0m  [1m[32mINSERT INTO "orders" ("user_id", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["user_id", 1], ["created_at", "2023-11-10 09:52:01.075677"], ["updated_at", "2023-11-10 09:52:01.075677"]]
  â†³ app/controllers/orders_controller.rb:9:in `create'
  [1m[36mTRANSACTION (5.1ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/controllers/orders_controller.rb:9:in `create'
  [1m[36mProduct Load (0.1ms)[0m  [1m[34mSELECT "products".* FROM "products" INNER JOIN "basket_products" ON "products"."id" = "basket_products"."product_id" WHERE "basket_products"."user_id" = ?[0m  [["user_id", 1]]
  â†³ app/controllers/orders_controller.rb:10:in `create'
Completed 500 Internal Server Error in 34ms (ActiveRecord: 7.5ms | Allocations: 19198)


  
NameError (undefined local variable or method `order_id' for #<OrdersController:0x00000000014870>):
  
app/controllers/orders_controller.rb:10:in `block in create'
app/controllers/orders_controller.rb:10:in `create'
Started POST "/users/1/orders" for ::1 at 2023-11-10 10:52:32 +0100
Processing by OrdersController#create as */*
  Parameters: {"user_id"=>"1"}
DEPRECATION WARNING: `Rails.application.secrets` is deprecated in favor of `Rails.application.credentials` and will be removed in Rails 7.2. (called from <class:JwtService> at /home/topper/rails_test/products_api/app/services/jwt_service.rb:2)
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:22:in `from_jwt'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/orders_controller.rb:9:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/controllers/orders_controller.rb:9:in `create'
  [1m[36mOrder Create (0.5ms)[0m  [1m[32mINSERT INTO "orders" ("user_id", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["user_id", 1], ["created_at", "2023-11-10 09:52:32.427655"], ["updated_at", "2023-11-10 09:52:32.427655"]]
  â†³ app/controllers/orders_controller.rb:9:in `create'
  [1m[36mTRANSACTION (4.6ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/controllers/orders_controller.rb:9:in `create'
  [1m[36mProduct Load (0.1ms)[0m  [1m[34mSELECT "products".* FROM "products" INNER JOIN "basket_products" ON "products"."id" = "basket_products"."product_id" WHERE "basket_products"."user_id" = ?[0m  [["user_id", 1]]
  â†³ app/controllers/orders_controller.rb:10:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/models/product.rb:9:in `to_ordered_product'
  [1m[36mOrder Load (0.7ms)[0m  [1m[34mSELECT "orders".* FROM "orders" WHERE "orders"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/models/product.rb:9:in `to_ordered_product'
  [1m[36mProduct Load (0.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/product.rb:9:in `to_ordered_product'
  [1m[36mOrderedProduct Create (0.1ms)[0m  [1m[32mINSERT INTO "ordered_products" ("order_id", "product_id", "baught_price", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["order_id", 2], ["product_id", 1], ["baught_price", 60], ["created_at", "2023-11-10 09:52:32.460162"], ["updated_at", "2023-11-10 09:52:32.460162"]]
  â†³ app/models/product.rb:9:in `to_ordered_product'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/models/product.rb:9:in `to_ordered_product'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/models/product.rb:9:in `to_ordered_product'
  [1m[36mOrder Load (0.5ms)[0m  [1m[34mSELECT "orders".* FROM "orders" WHERE "orders"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/models/product.rb:9:in `to_ordered_product'
  [1m[36mProduct Load (0.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/models/product.rb:9:in `to_ordered_product'
  [1m[36mOrderedProduct Create (0.1ms)[0m  [1m[32mINSERT INTO "ordered_products" ("order_id", "product_id", "baught_price", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["order_id", 2], ["product_id", 2], ["baught_price", 120], ["created_at", "2023-11-10 09:52:32.463685"], ["updated_at", "2023-11-10 09:52:32.463685"]]
  â†³ app/models/product.rb:9:in `to_ordered_product'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/models/product.rb:9:in `to_ordered_product'
Completed 200 OK in 52ms (Views: 0.2ms | ActiveRecord: 8.7ms | Allocations: 31727)


Started GET "/users/1/orders" for ::1 at 2023-11-10 10:52:37 +0100
Processing by OrdersController#index as */*
  Parameters: {"user_id"=>"1"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:22:in `from_jwt'
  [1m[36mOrder Load (0.1ms)[0m  [1m[34mSELECT "orders".* FROM "orders" WHERE "orders"."user_id" = ?[0m  [["user_id", 1]]
  â†³ app/controllers/application_controller.rb:22:in `success_response'
Completed 200 OK in 2ms (Views: 1.1ms | ActiveRecord: 0.1ms | Allocations: 1473)


Started GET "/users/1/baskets" for ::1 at 2023-11-10 10:53:01 +0100
Processing by BasketsController#show as */*
  Parameters: {"user_id"=>"1"}
DEPRECATION WARNING: `Rails.application.secrets` is deprecated in favor of `Rails.application.credentials` and will be removed in Rails 7.2. (called from <class:JwtService> at /home/topper/rails_test/products_api/app/services/jwt_service.rb:2)
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:22:in `from_jwt'
  [1m[36mBasketProduct Load (0.1ms)[0m  [1m[34mSELECT "basket_products".* FROM "basket_products" WHERE "basket_products"."user_id" = ? AND "basket_products"."amount" != ?[0m  [["user_id", 1], ["amount", 0]]
  â†³ app/controllers/baskets_controller.rb:6:in `map'
  [1m[36mProduct Load (0.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" IN (?, ?)[0m  [["id", 1], ["id", 2]]
  â†³ app/controllers/baskets_controller.rb:6:in `map'
Completed 200 OK in 32ms (Views: 0.4ms | ActiveRecord: 1.9ms | Allocations: 17504)


Started POST "/users/1/orders" for ::1 at 2023-11-10 10:53:07 +0100
Processing by OrdersController#create as */*
  Parameters: {"user_id"=>"1"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:22:in `from_jwt'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/orders_controller.rb:9:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/controllers/orders_controller.rb:9:in `create'
  [1m[36mOrder Create (0.8ms)[0m  [1m[32mINSERT INTO "orders" ("user_id", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["user_id", 1], ["created_at", "2023-11-10 09:53:07.791307"], ["updated_at", "2023-11-10 09:53:07.791307"]]
  â†³ app/controllers/orders_controller.rb:9:in `create'
  [1m[36mTRANSACTION (4.7ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/controllers/orders_controller.rb:9:in `create'
  [1m[36mProduct Load (0.1ms)[0m  [1m[34mSELECT "products".* FROM "products" INNER JOIN "basket_products" ON "products"."id" = "basket_products"."product_id" WHERE "basket_products"."user_id" = ?[0m  [["user_id", 1]]
  â†³ app/controllers/orders_controller.rb:10:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/models/product.rb:9:in `to_ordered_product'
  [1m[36mOrder Load (0.6ms)[0m  [1m[34mSELECT "orders".* FROM "orders" WHERE "orders"."id" = ? LIMIT ?[0m  [["id", 3], ["LIMIT", 1]]
  â†³ app/models/product.rb:9:in `to_ordered_product'
  [1m[36mProduct Load (0.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/product.rb:9:in `to_ordered_product'
  [1m[36mOrderedProduct Create (0.1ms)[0m  [1m[32mINSERT INTO "ordered_products" ("order_id", "product_id", "baught_price", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["order_id", 3], ["product_id", 1], ["baught_price", 60], ["created_at", "2023-11-10 09:53:07.807487"], ["updated_at", "2023-11-10 09:53:07.807487"]]
  â†³ app/models/product.rb:9:in `to_ordered_product'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/models/product.rb:9:in `to_ordered_product'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/models/product.rb:9:in `to_ordered_product'
  [1m[36mOrder Load (0.5ms)[0m  [1m[34mSELECT "orders".* FROM "orders" WHERE "orders"."id" = ? LIMIT ?[0m  [["id", 3], ["LIMIT", 1]]
  â†³ app/models/product.rb:9:in `to_ordered_product'
  [1m[36mProduct Load (0.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/models/product.rb:9:in `to_ordered_product'
  [1m[36mOrderedProduct Create (0.1ms)[0m  [1m[32mINSERT INTO "ordered_products" ("order_id", "product_id", "baught_price", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["order_id", 3], ["product_id", 2], ["baught_price", 120], ["created_at", "2023-11-10 09:53:07.810809"], ["updated_at", "2023-11-10 09:53:07.810809"]]
  â†³ app/models/product.rb:9:in `to_ordered_product'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/models/product.rb:9:in `to_ordered_product'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/controllers/orders_controller.rb:11:in `create'
  [1m[36mBasketProduct Load (0.5ms)[0m  [1m[34mSELECT "basket_products".* FROM "basket_products" WHERE "basket_products"."user_id" = ? AND "basket_products"."product_id" IN (?, ?)[0m  [["user_id", 1], ["product_id", 1], ["product_id", 2]]
  â†³ app/controllers/orders_controller.rb:11:in `create'
  [1m[36mBasketProduct Destroy (0.0ms)[0m  [1m[31mDELETE FROM "basket_products" WHERE "basket_products"."id" = ?[0m  [["id", 1]]
  â†³ app/controllers/orders_controller.rb:11:in `create'
  [1m[36mBasketProduct Destroy (0.1ms)[0m  [1m[31mDELETE FROM "basket_products" WHERE "basket_products"."id" = ?[0m  [["id", 2]]
  â†³ app/controllers/orders_controller.rb:11:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/controllers/orders_controller.rb:11:in `create'
Completed 200 OK in 32ms (Views: 0.2ms | ActiveRecord: 8.2ms | Allocations: 21252)


Started GET "/users/1/baskets" for ::1 at 2023-11-10 10:53:12 +0100
Processing by BasketsController#show as */*
  Parameters: {"user_id"=>"1"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:22:in `from_jwt'
  [1m[36mBasketProduct Load (0.0ms)[0m  [1m[34mSELECT "basket_products".* FROM "basket_products" WHERE "basket_products"."user_id" = ? AND "basket_products"."amount" != ?[0m  [["user_id", 1], ["amount", 0]]
  â†³ app/controllers/baskets_controller.rb:6:in `map'
Completed 200 OK in 2ms (Views: 0.1ms | ActiveRecord: 0.1ms | Allocations: 1118)


  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[35m (5.8ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'development', '2023-11-10 09:55:56.544711', '2023-11-10 09:55:56.544714') RETURNING "key"[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateUsersTable (20231106120630)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "full_name" varchar, "email" varchar, "password_digest" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_users_on_email" ON "users" ("email")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20231106120630') RETURNING "version"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mcommit transaction[0m
Migrating to CreateProducts (20231106215035)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "description" text, "price" integer, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20231106215035') RETURNING "version"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
Migrating to CreateBasket (20231107115131)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE TABLE "basket_products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "user_id" integer, "product_id" integer, "amount" integer, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20231107115131') RETURNING "version"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
Migrating to CreateOrders (20231110093551)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE TABLE "orders" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "user_id" integer, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "ordered_products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "order_id" integer, "product_id" integer, "baught_price" integer, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20231110093551') RETURNING "version"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mUser Exists? (1.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "admin@test.dk"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("full_name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["full_name", "Super Admin"], ["email", "admin@test.dk"], ["password_digest", "[FILTERED]"], ["created_at", "2023-11-10 09:55:58.722774"], ["updated_at", "2023-11-10 09:55:58.722774"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mProduct Create (2.9ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Shoe"], ["description", "A very nice shoe in hight quality"], ["price", 60], ["created_at", "2023-11-10 09:55:58.773227"], ["updated_at", "2023-11-10 09:55:58.773227"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mProduct Create (0.6ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Jacket"], ["description", "A very nice jacket in hight quality"], ["price", 120], ["created_at", "2023-11-10 09:55:58.778139"], ["updated_at", "2023-11-10 09:55:58.778139"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mBasketProduct Create (0.1ms)[0m  [1m[32mINSERT INTO "basket_products" ("user_id", "product_id", "amount", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["user_id", 1], ["product_id", 1], ["amount", nil], ["created_at", "2023-11-10 09:55:58.801209"], ["updated_at", "2023-11-10 09:55:58.801209"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mBasketProduct Load (0.0ms)[0m  [1m[34mSELECT "basket_products".* FROM "basket_products" WHERE "basket_products"."product_id" = ? LIMIT ?[0m  [["product_id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mBasketProduct Update (0.7ms)[0m  [1m[33mUPDATE "basket_products" SET "amount" = ?, "updated_at" = ? WHERE "basket_products"."id" = ?[0m  [["amount", 2], ["updated_at", "2023-11-10 09:55:58.803651"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mBasketProduct Create (0.1ms)[0m  [1m[32mINSERT INTO "basket_products" ("user_id", "product_id", "amount", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["user_id", 1], ["product_id", 2], ["amount", nil], ["created_at", "2023-11-10 09:55:58.807662"], ["updated_at", "2023-11-10 09:55:58.807662"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mBasketProduct Load (0.0ms)[0m  [1m[34mSELECT "basket_products".* FROM "basket_products" WHERE "basket_products"."product_id" = ? LIMIT ?[0m  [["product_id", 2], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mBasketProduct Update (0.8ms)[0m  [1m[33mUPDATE "basket_products" SET "amount" = ?, "updated_at" = ? WHERE "basket_products"."id" = ?[0m  [["amount", 0], ["updated_at", "2023-11-10 09:55:58.809754"], ["id", 2]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mUser Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "admin@test.dk"], ["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mProduct Create (0.6ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "price", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Ordered product"], ["description", "A product the user has ordered"], ["price", 69], ["created_at", "2023-11-10 09:55:58.813972"], ["updated_at", "2023-11-10 09:55:58.813972"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mOrder Create (0.1ms)[0m  [1m[32mINSERT INTO "orders" ("user_id", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["user_id", 1], ["created_at", "2023-11-10 09:55:58.821525"], ["updated_at", "2023-11-10 09:55:58.821525"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/models/product.rb:9:in `to_ordered_product'
  [1m[36mOrder Load (0.5ms)[0m  [1m[34mSELECT "orders".* FROM "orders" WHERE "orders"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/product.rb:9:in `to_ordered_product'
  [1m[36mProduct Load (0.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = ? LIMIT ?[0m  [["id", 3], ["LIMIT", 1]]
  â†³ app/models/product.rb:9:in `to_ordered_product'
  [1m[36mOrderedProduct Create (0.1ms)[0m  [1m[32mINSERT INTO "ordered_products" ("order_id", "product_id", "baught_price", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["order_id", 1], ["product_id", 3], ["baught_price", 69], ["created_at", "2023-11-10 09:55:58.835356"], ["updated_at", "2023-11-10 09:55:58.835356"]]
  â†³ app/models/product.rb:9:in `to_ordered_product'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/models/product.rb:9:in `to_ordered_product'
Started GET "/users/1/baskets" for ::1 at 2023-11-10 10:56:04 +0100
Processing by BasketsController#show as */*
  Parameters: {"user_id"=>"1"}
DEPRECATION WARNING: `Rails.application.secrets` is deprecated in favor of `Rails.application.credentials` and will be removed in Rails 7.2. (called from <class:JwtService> at /home/topper/rails_test/products_api/app/services/jwt_service.rb:2)
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:22:in `from_jwt'
  [1m[36mBasketProduct Load (0.1ms)[0m  [1m[34mSELECT "basket_products".* FROM "basket_products" WHERE "basket_products"."user_id" = ? AND "basket_products"."amount" != ?[0m  [["user_id", 1], ["amount", 0]]
  â†³ app/controllers/baskets_controller.rb:6:in `map'
  [1m[36mProduct Load (0.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = ?[0m  [["id", 1]]
  â†³ app/controllers/baskets_controller.rb:6:in `map'
Completed 200 OK in 25ms (Views: 0.2ms | ActiveRecord: 1.9ms | Allocations: 15365)


Started GET "/users/1/orders" for ::1 at 2023-11-10 10:56:09 +0100
Processing by OrdersController#index as */*
  Parameters: {"user_id"=>"1"}
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:22:in `from_jwt'
  [1m[36mOrder Load (0.0ms)[0m  [1m[34mSELECT "orders".* FROM "orders" WHERE "orders"."user_id" = ?[0m  [["user_id", 1]]
  â†³ app/controllers/application_controller.rb:22:in `success_response'
Completed 200 OK in 6ms (Views: 2.7ms | ActiveRecord: 0.3ms | Allocations: 4705)


Started GET "/users/1/orders" for ::1 at 2023-11-10 10:56:52 +0100
Processing by OrdersController#index as */*
  Parameters: {"user_id"=>"1"}
DEPRECATION WARNING: `Rails.application.secrets` is deprecated in favor of `Rails.application.credentials` and will be removed in Rails 7.2. (called from <class:JwtService> at /home/topper/rails_test/products_api/app/services/jwt_service.rb:2)
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:22:in `from_jwt'
Completed 500 Internal Server Error in 14ms (ActiveRecord: 1.2ms | Allocations: 7684)


  
TypeError (wrong argument type Symbol (expected Module)):
  
app/controllers/orders_controller.rb:5:in `index'
Started GET "/users/1/orders" for ::1 at 2023-11-10 10:56:57 +0100
Processing by OrdersController#index as */*
  Parameters: {"user_id"=>"1"}
DEPRECATION WARNING: `Rails.application.secrets` is deprecated in favor of `Rails.application.credentials` and will be removed in Rails 7.2. (called from <class:JwtService> at /home/topper/rails_test/products_api/app/services/jwt_service.rb:2)
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:22:in `from_jwt'
  [1m[36mOrder Load (0.0ms)[0m  [1m[34mSELECT "orders".* FROM "orders" WHERE "orders"."user_id" = ?[0m  [["user_id", 1]]
  â†³ app/controllers/application_controller.rb:22:in `success_response'
  [1m[36mOrderedProduct Load (0.1ms)[0m  [1m[34mSELECT "ordered_products".* FROM "ordered_products" WHERE "ordered_products"."order_id" = ?[0m  [["order_id", 1]]
  â†³ app/controllers/application_controller.rb:22:in `success_response'
Completed 200 OK in 19ms (Views: 7.8ms | ActiveRecord: 1.4ms | Allocations: 14963)


Started GET "/users/1/orders" for ::1 at 2023-11-10 10:59:20 +0100
Processing by OrdersController#index as */*
  Parameters: {"user_id"=>"1"}
DEPRECATION WARNING: `Rails.application.secrets` is deprecated in favor of `Rails.application.credentials` and will be removed in Rails 7.2. (called from <class:JwtService> at /home/topper/rails_test/products_api/app/services/jwt_service.rb:2)
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:22:in `from_jwt'
  [1m[36mOrder Load (0.0ms)[0m  [1m[34mSELECT "orders".* FROM "orders" WHERE "orders"."user_id" = ?[0m  [["user_id", 1]]
  â†³ app/controllers/orders_controller.rb:5:in `index'
  [1m[36mOrderedProduct Load (0.1ms)[0m  [1m[34mSELECT "ordered_products".* FROM "ordered_products" WHERE "ordered_products"."order_id" = ?[0m  [["order_id", 1]]
  â†³ app/controllers/orders_controller.rb:5:in `index'
Completed 200 OK in 22ms (Views: 0.2ms | ActiveRecord: 1.6ms | Allocations: 14758)


Started GET "/users/1/orders" for ::1 at 2023-11-10 10:59:33 +0100
Processing by OrdersController#index as */*
  Parameters: {"user_id"=>"1"}
DEPRECATION WARNING: `Rails.application.secrets` is deprecated in favor of `Rails.application.credentials` and will be removed in Rails 7.2. (called from <class:JwtService> at /home/topper/rails_test/products_api/app/services/jwt_service.rb:2)
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:22:in `from_jwt'
  [1m[36mOrder Load (0.1ms)[0m  [1m[34mSELECT "orders".* FROM "orders" WHERE "orders"."user_id" = ?[0m  [["user_id", 1]]
  â†³ app/controllers/orders_controller.rb:5:in `index'
  [1m[36mOrderedProduct Load (0.1ms)[0m  [1m[34mSELECT "ordered_products".* FROM "ordered_products" WHERE "ordered_products"."order_id" = ?[0m  [["order_id", 1]]
  â†³ app/controllers/orders_controller.rb:5:in `index'
Completed 500 Internal Server Error in 21ms (ActiveRecord: 1.7ms | Allocations: 14674)


  
NoMethodError (undefined method `products' for #<Order id: 1, user_id: 1, created_at: "2023-11-10 09:55:58.821525000 +0000", updated_at: "2023-11-10 09:55:58.821525000 +0000">):
  
app/controllers/orders_controller.rb:5:in `index'
Started GET "/users/1/orders" for ::1 at 2023-11-10 10:59:38 +0100
Processing by OrdersController#index as */*
  Parameters: {"user_id"=>"1"}
DEPRECATION WARNING: `Rails.application.secrets` is deprecated in favor of `Rails.application.credentials` and will be removed in Rails 7.2. (called from <class:JwtService> at /home/topper/rails_test/products_api/app/services/jwt_service.rb:2)
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:22:in `from_jwt'
  [1m[36mOrder Load (0.0ms)[0m  [1m[34mSELECT "orders".* FROM "orders" WHERE "orders"."user_id" = ?[0m  [["user_id", 1]]
  â†³ app/controllers/orders_controller.rb:5:in `index'
  [1m[36mOrderedProduct Load (0.1ms)[0m  [1m[34mSELECT "ordered_products".* FROM "ordered_products" WHERE "ordered_products"."order_id" = ?[0m  [["order_id", 1]]
  â†³ app/controllers/orders_controller.rb:5:in `index'
Completed 200 OK in 24ms (Views: 0.2ms | ActiveRecord: 2.5ms | Allocations: 14825)


Started GET "/users/1/orders/1" for ::1 at 2023-11-10 11:02:44 +0100
Processing by OrdersController#show as */*
  Parameters: {"user_id"=>"1", "id"=>"1"}
DEPRECATION WARNING: `Rails.application.secrets` is deprecated in favor of `Rails.application.credentials` and will be removed in Rails 7.2. (called from <class:JwtService> at /home/topper/rails_test/products_api/app/services/jwt_service.rb:2)
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:22:in `from_jwt'
  [1m[36mOrder Load (0.2ms)[0m  [1m[34mSELECT "orders".* FROM "orders" WHERE "orders"."user_id" = ? AND "orders"."order_id" = ?[0m  [["user_id", 1], ["order_id", "1"]]
  â†³ app/controllers/orders_controller.rb:10:in `show'
Completed 500 Internal Server Error in 13ms (ActiveRecord: 1.5ms | Allocations: 8157)


  
ActiveRecord::StatementInvalid (SQLite3::SQLException: no such column: orders.order_id):
  
Started GET "/users/1/orders/1" for ::1 at 2023-11-10 11:03:05 +0100
Processing by OrdersController#show as */*
  Parameters: {"user_id"=>"1", "id"=>"1"}
DEPRECATION WARNING: `Rails.application.secrets` is deprecated in favor of `Rails.application.credentials` and will be removed in Rails 7.2. (called from <class:JwtService> at /home/topper/rails_test/products_api/app/services/jwt_service.rb:2)
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:22:in `from_jwt'
  [1m[36mOrder Load (0.1ms)[0m  [1m[34mSELECT "orders".* FROM "orders" WHERE "orders"."user_id" = ? AND "orders"."id" = ?[0m  [["user_id", 1], ["id", 1]]
  â†³ app/controllers/orders_controller.rb:10:in `show'
  [1m[36mOrderedProduct Load (0.1ms)[0m  [1m[34mSELECT "ordered_products".* FROM "ordered_products" WHERE "ordered_products"."order_id" = ?[0m  [["order_id", 1]]
  â†³ app/controllers/orders_controller.rb:10:in `show'
Completed 200 OK in 21ms (Views: 0.1ms | ActiveRecord: 1.5ms | Allocations: 14804)


Started GET "/users/1/orders/1" for ::1 at 2023-11-10 11:03:16 +0100
Processing by OrdersController#show as */*
  Parameters: {"user_id"=>"1", "id"=>"1"}
DEPRECATION WARNING: `Rails.application.secrets` is deprecated in favor of `Rails.application.credentials` and will be removed in Rails 7.2. (called from <class:JwtService> at /home/topper/rails_test/products_api/app/services/jwt_service.rb:2)
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:22:in `from_jwt'
  [1m[36mOrder Load (0.1ms)[0m  [1m[34mSELECT "orders".* FROM "orders" WHERE "orders"."user_id" = ? AND "orders"."id" = ? LIMIT ?[0m  [["user_id", 1], ["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/orders_controller.rb:9:in `show'
Completed 500 Internal Server Error in 16ms (ActiveRecord: 2.1ms | Allocations: 9996)


  
NoMethodError (undefined method `includes' for #<Order id: 1, user_id: 1, created_at: "2023-11-10 09:55:58.821525000 +0000", updated_at: "2023-11-10 09:55:58.821525000 +0000">):
  
app/controllers/orders_controller.rb:9:in `show'
Started GET "/users/1/orders/1" for ::1 at 2023-11-10 11:03:40 +0100
Processing by OrdersController#show as */*
  Parameters: {"user_id"=>"1", "id"=>"1"}
DEPRECATION WARNING: `Rails.application.secrets` is deprecated in favor of `Rails.application.credentials` and will be removed in Rails 7.2. (called from <class:JwtService> at /home/topper/rails_test/products_api/app/services/jwt_service.rb:2)
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:22:in `from_jwt'
  [1m[36mOrder Load (0.1ms)[0m  [1m[34mSELECT "orders".* FROM "orders" WHERE "orders"."user_id" = ? AND (1) ORDER BY "orders"."id" ASC LIMIT ?[0m  [["user_id", 1], ["LIMIT", 1]]
  â†³ app/controllers/orders_controller.rb:10:in `show'
  [1m[36mOrderedProduct Load (0.1ms)[0m  [1m[34mSELECT "ordered_products".* FROM "ordered_products" WHERE "ordered_products"."order_id" = ?[0m  [["order_id", 1]]
  â†³ app/controllers/orders_controller.rb:10:in `show'
Completed 200 OK in 22ms (Views: 0.1ms | ActiveRecord: 1.6ms | Allocations: 15112)


Started GET "/users/1/orders/1" for ::1 at 2023-11-10 11:03:51 +0100
Processing by OrdersController#show as */*
  Parameters: {"user_id"=>"1", "id"=>"1"}
DEPRECATION WARNING: `Rails.application.secrets` is deprecated in favor of `Rails.application.credentials` and will be removed in Rails 7.2. (called from <class:JwtService> at /home/topper/rails_test/products_api/app/services/jwt_service.rb:2)
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:22:in `from_jwt'
  [1m[36mOrder Load (0.1ms)[0m  [1m[34mSELECT "orders".* FROM "orders" WHERE "orders"."user_id" = ? AND "orders"."id" = ? ORDER BY "orders"."id" ASC LIMIT ?[0m  [["user_id", 1], ["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/orders_controller.rb:10:in `show'
  [1m[36mOrderedProduct Load (0.1ms)[0m  [1m[34mSELECT "ordered_products".* FROM "ordered_products" WHERE "ordered_products"."order_id" = ?[0m  [["order_id", 1]]
  â†³ app/controllers/orders_controller.rb:10:in `show'
Completed 200 OK in 22ms (Views: 0.1ms | ActiveRecord: 1.7ms | Allocations: 15008)


Started GET "/users/1/orders/2" for ::1 at 2023-11-10 11:03:56 +0100
Processing by OrdersController#show as */*
  Parameters: {"user_id"=>"1", "id"=>"2"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:22:in `from_jwt'
  [1m[36mOrder Load (0.0ms)[0m  [1m[34mSELECT "orders".* FROM "orders" WHERE "orders"."user_id" = ? AND "orders"."id" = ? ORDER BY "orders"."id" ASC LIMIT ?[0m  [["user_id", 1], ["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/orders_controller.rb:10:in `show'
Completed 200 OK in 2ms (Views: 0.1ms | ActiveRecord: 0.1ms | Allocations: 1193)


Started GET "/users/1/orders/2" for ::1 at 2023-11-10 11:05:31 +0100
Processing by OrdersController#show as */*
  Parameters: {"user_id"=>"1", "id"=>"2"}
DEPRECATION WARNING: `Rails.application.secrets` is deprecated in favor of `Rails.application.credentials` and will be removed in Rails 7.2. (called from <class:JwtService> at /home/topper/rails_test/products_api/app/services/jwt_service.rb:2)
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:22:in `from_jwt'
  [1m[36mOrder Load (0.0ms)[0m  [1m[34mSELECT "orders".* FROM "orders" WHERE "orders"."user_id" = ? AND "orders"."id" = ? ORDER BY "orders"."id" ASC LIMIT ?[0m  [["user_id", 1], ["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/orders_controller.rb:10:in `show'
Completed 200 OK in 15ms (Views: 0.1ms | ActiveRecord: 1.4ms | Allocations: 8400)


Started GET "/users/1/orders/2" for ::1 at 2023-11-10 11:05:46 +0100
Processing by OrdersController#show as */*
  Parameters: {"user_id"=>"1", "id"=>"2"}
DEPRECATION WARNING: `Rails.application.secrets` is deprecated in favor of `Rails.application.credentials` and will be removed in Rails 7.2. (called from <class:JwtService> at /home/topper/rails_test/products_api/app/services/jwt_service.rb:2)
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:22:in `from_jwt'
  [1m[36mOrder Load (0.1ms)[0m  [1m[34mSELECT "orders".* FROM "orders" WHERE "orders"."user_id" = ? AND "orders"."id" = ? ORDER BY "orders"."id" ASC LIMIT ?[0m  [["user_id", 1], ["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/orders_controller.rb:13:in `show'
Completed 200 OK in 14ms (Views: 0.2ms | ActiveRecord: 1.4ms | Allocations: 8356)


Started GET "/users/1/orders/2" for ::1 at 2023-11-10 11:05:54 +0100
Processing by OrdersController#show as */*
  Parameters: {"user_id"=>"1", "id"=>"2"}
DEPRECATION WARNING: `Rails.application.secrets` is deprecated in favor of `Rails.application.credentials` and will be removed in Rails 7.2. (called from <class:JwtService> at /home/topper/rails_test/products_api/app/services/jwt_service.rb:2)
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:22:in `from_jwt'
  [1m[36mOrder Load (0.1ms)[0m  [1m[34mSELECT "orders".* FROM "orders" WHERE "orders"."user_id" = ? AND "orders"."id" = ? /* loading for inspect */ LIMIT ?[0m  [["user_id", 1], ["id", 2], ["LIMIT", 11]]
  â†³ app/controllers/orders_controller.rb:11:in `show'
  [1m[36mOrder Load (0.1ms)[0m  [1m[34mSELECT "orders".* FROM "orders" WHERE "orders"."user_id" = ? AND "orders"."id" = ? ORDER BY "orders"."id" ASC LIMIT ?[0m  [["user_id", 1], ["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/orders_controller.rb:14:in `show'
Completed 200 OK in 23682ms (Views: 0.2ms | ActiveRecord: 1.4ms | Allocations: 61320)


Started GET "/users/1/orders/2" for ::1 at 2023-11-10 11:06:27 +0100
Processing by OrdersController#show as */*
  Parameters: {"user_id"=>"1", "id"=>"2"}
DEPRECATION WARNING: `Rails.application.secrets` is deprecated in favor of `Rails.application.credentials` and will be removed in Rails 7.2. (called from <class:JwtService> at /home/topper/rails_test/products_api/app/services/jwt_service.rb:2)
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:22:in `from_jwt'
  [1m[36mOrder Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "orders" WHERE "orders"."user_id" = ? AND "orders"."id" = ? LIMIT ?[0m  [["user_id", 1], ["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/orders_controller.rb:10:in `show'
  [1m[36mOrder Load (0.1ms)[0m  [1m[34mSELECT "orders".* FROM "orders" WHERE "orders"."user_id" = ? AND "orders"."id" = ? ORDER BY "orders"."id" ASC LIMIT ?[0m  [["user_id", 1], ["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/orders_controller.rb:13:in `show'
Completed 200 OK in 17ms (Views: 0.1ms | ActiveRecord: 1.5ms | Allocations: 9951)


Started GET "/users/1/orders/2" for ::1 at 2023-11-10 11:06:28 +0100
Processing by OrdersController#show as */*
  Parameters: {"user_id"=>"1", "id"=>"2"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:22:in `from_jwt'
  [1m[36mOrder Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "orders" WHERE "orders"."user_id" = ? AND "orders"."id" = ? LIMIT ?[0m  [["user_id", 1], ["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/orders_controller.rb:10:in `show'
  [1m[36mOrder Load (0.0ms)[0m  [1m[34mSELECT "orders".* FROM "orders" WHERE "orders"."user_id" = ? AND "orders"."id" = ? ORDER BY "orders"."id" ASC LIMIT ?[0m  [["user_id", 1], ["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/orders_controller.rb:13:in `show'
Completed 200 OK in 2ms (Views: 0.1ms | ActiveRecord: 0.1ms | Allocations: 1580)


Started GET "/users/1/orders/2" for ::1 at 2023-11-10 11:06:34 +0100
Processing by OrdersController#show as */*
  Parameters: {"user_id"=>"1", "id"=>"2"}
DEPRECATION WARNING: `Rails.application.secrets` is deprecated in favor of `Rails.application.credentials` and will be removed in Rails 7.2. (called from <class:JwtService> at /home/topper/rails_test/products_api/app/services/jwt_service.rb:2)
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:22:in `from_jwt'
  [1m[36mOrder Load (0.0ms)[0m  [1m[34mSELECT "orders".* FROM "orders" WHERE "orders"."user_id" = ? AND "orders"."id" = ?[0m  [["user_id", 1], ["id", 2]]
  â†³ app/controllers/orders_controller.rb:10:in `show'
Completed 200 OK in 12ms (Views: 0.1ms | ActiveRecord: 1.4ms | Allocations: 8165)


Started GET "/users/1/orders/2" for ::1 at 2023-11-10 11:06:38 +0100
Processing by OrdersController#show as */*
  Parameters: {"user_id"=>"1", "id"=>"2"}
DEPRECATION WARNING: `Rails.application.secrets` is deprecated in favor of `Rails.application.credentials` and will be removed in Rails 7.2. (called from <class:JwtService> at /home/topper/rails_test/products_api/app/services/jwt_service.rb:2)
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:22:in `from_jwt'
  [1m[36mOrder Load (0.0ms)[0m  [1m[34mSELECT "orders".* FROM "orders" WHERE "orders"."user_id" = ? AND "orders"."id" = ?[0m  [["user_id", 1], ["id", 2]]
  â†³ app/controllers/orders_controller.rb:10:in `show'
Completed 404 Not Found in 14ms (Views: 0.1ms | ActiveRecord: 1.3ms | Allocations: 8197)


Started POST "/users/1/orders/2" for ::1 at 2023-11-10 11:09:32 +0100
  
ActionController::RoutingError (No route matches [POST] "/users/1/orders/2"):
  
Started POST "/users/1/orders" for ::1 at 2023-11-10 11:09:43 +0100
Processing by OrdersController#create as */*
  Parameters: {"user_id"=>"1"}
DEPRECATION WARNING: `Rails.application.secrets` is deprecated in favor of `Rails.application.credentials` and will be removed in Rails 7.2. (called from <class:JwtService> at /home/topper/rails_test/products_api/app/services/jwt_service.rb:2)
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:22:in `from_jwt'
Completed 500 Internal Server Error in 9ms (Views: 0.1ms | ActiveRecord: 1.4ms | Allocations: 5958)


Started POST "/users/1/orders" for ::1 at 2023-11-10 11:09:56 +0100
Processing by OrdersController#create as */*
  Parameters: {"user_id"=>"1"}
DEPRECATION WARNING: `Rails.application.secrets` is deprecated in favor of `Rails.application.credentials` and will be removed in Rails 7.2. (called from <class:JwtService> at /home/topper/rails_test/products_api/app/services/jwt_service.rb:2)
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:22:in `from_jwt'
Completed 500 Internal Server Error in 8ms (ActiveRecord: 1.1ms | Allocations: 5965)


  
NameError (undefined local variable or method `e' for #<OrdersController:0x00000000065360>):
  
app/controllers/orders_controller.rb:23:in `rescue in create'
app/controllers/orders_controller.rb:17:in `create'
Started POST "/users/1/orders" for ::1 at 2023-11-10 11:11:57 +0100
Processing by OrdersController#create as */*
  Parameters: {"user_id"=>"1"}
DEPRECATION WARNING: `Rails.application.secrets` is deprecated in favor of `Rails.application.credentials` and will be removed in Rails 7.2. (called from <class:JwtService> at /home/topper/rails_test/products_api/app/services/jwt_service.rb:2)
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:22:in `from_jwt'
Completed 500 Internal Server Error in 11ms (Views: 0.1ms | ActiveRecord: 1.1ms | Allocations: 6061)


Started POST "/users/1/orders" for ::1 at 2023-11-10 11:14:46 +0100
Processing by OrdersController#create as */*
  Parameters: {"user_id"=>"1"}
DEPRECATION WARNING: `Rails.application.secrets` is deprecated in favor of `Rails.application.credentials` and will be removed in Rails 7.2. (called from <class:JwtService> at /home/topper/rails_test/products_api/app/services/jwt_service.rb:2)
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:22:in `from_jwt'
  [1m[36mProduct Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "products" INNER JOIN "basket_products" ON "products"."id" = "basket_products"."product_id" WHERE "basket_products"."user_id" = ? LIMIT ?[0m  [["user_id", 1], ["LIMIT", 1]]
  â†³ app/controllers/orders_controller.rb:18:in `create'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/orders_controller.rb:22:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/controllers/orders_controller.rb:22:in `create'
  [1m[36mOrder Create (0.6ms)[0m  [1m[32mINSERT INTO "orders" ("user_id", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["user_id", 1], ["created_at", "2023-11-10 10:14:46.672684"], ["updated_at", "2023-11-10 10:14:46.672684"]]
  â†³ app/controllers/orders_controller.rb:22:in `create'
  [1m[36mTRANSACTION (5.2ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/controllers/orders_controller.rb:22:in `create'
  [1m[36mProduct Load (0.1ms)[0m  [1m[34mSELECT "products".* FROM "products" INNER JOIN "basket_products" ON "products"."id" = "basket_products"."product_id" WHERE "basket_products"."user_id" = ?[0m  [["user_id", 1]]
  â†³ app/controllers/orders_controller.rb:23:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/models/product.rb:9:in `to_ordered_product!'
  [1m[36mOrder Load (0.7ms)[0m  [1m[34mSELECT "orders".* FROM "orders" WHERE "orders"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/models/product.rb:9:in `to_ordered_product!'
  [1m[36mProduct Load (0.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/product.rb:9:in `to_ordered_product!'
  [1m[36mOrderedProduct Create (0.1ms)[0m  [1m[32mINSERT INTO "ordered_products" ("order_id", "product_id", "baught_price", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["order_id", 2], ["product_id", 1], ["baught_price", 60], ["created_at", "2023-11-10 10:14:46.691955"], ["updated_at", "2023-11-10 10:14:46.691955"]]
  â†³ app/models/product.rb:9:in `to_ordered_product!'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/models/product.rb:9:in `to_ordered_product!'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/models/product.rb:9:in `to_ordered_product!'
  [1m[36mOrder Load (0.5ms)[0m  [1m[34mSELECT "orders".* FROM "orders" WHERE "orders"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/models/product.rb:9:in `to_ordered_product!'
  [1m[36mProduct Load (0.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/models/product.rb:9:in `to_ordered_product!'
  [1m[36mOrderedProduct Create (0.1ms)[0m  [1m[32mINSERT INTO "ordered_products" ("order_id", "product_id", "baught_price", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["order_id", 2], ["product_id", 2], ["baught_price", 120], ["created_at", "2023-11-10 10:14:46.695238"], ["updated_at", "2023-11-10 10:14:46.695238"]]
  â†³ app/models/product.rb:9:in `to_ordered_product!'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/models/product.rb:9:in `to_ordered_product!'
Completed 500 Internal Server Error in 49ms (Views: 0.1ms | ActiveRecord: 9.8ms | Allocations: 30478)


Started POST "/users/1/orders" for ::1 at 2023-11-10 11:15:11 +0100
Processing by OrdersController#create as */*
  Parameters: {"user_id"=>"1"}
DEPRECATION WARNING: `Rails.application.secrets` is deprecated in favor of `Rails.application.credentials` and will be removed in Rails 7.2. (called from <class:JwtService> at /home/topper/rails_test/products_api/app/services/jwt_service.rb:2)
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:22:in `from_jwt'
  [1m[36mProduct Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "products" INNER JOIN "basket_products" ON "products"."id" = "basket_products"."product_id" WHERE "basket_products"."user_id" = ? LIMIT ?[0m  [["user_id", 1], ["LIMIT", 1]]
  â†³ app/controllers/orders_controller.rb:18:in `create'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/orders_controller.rb:22:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/controllers/orders_controller.rb:22:in `create'
  [1m[36mOrder Create (0.6ms)[0m  [1m[32mINSERT INTO "orders" ("user_id", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["user_id", 1], ["created_at", "2023-11-10 10:15:11.794371"], ["updated_at", "2023-11-10 10:15:11.794371"]]
  â†³ app/controllers/orders_controller.rb:22:in `create'
  [1m[36mTRANSACTION (5.3ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/controllers/orders_controller.rb:22:in `create'
  [1m[36mProduct Load (0.1ms)[0m  [1m[34mSELECT "products".* FROM "products" INNER JOIN "basket_products" ON "products"."id" = "basket_products"."product_id" WHERE "basket_products"."user_id" = ?[0m  [["user_id", 1]]
  â†³ app/controllers/orders_controller.rb:23:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/models/product.rb:9:in `to_ordered_product!'
  [1m[36mOrder Load (0.7ms)[0m  [1m[34mSELECT "orders".* FROM "orders" WHERE "orders"."id" = ? LIMIT ?[0m  [["id", 3], ["LIMIT", 1]]
  â†³ app/models/product.rb:9:in `to_ordered_product!'
  [1m[36mProduct Load (0.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/product.rb:9:in `to_ordered_product!'
  [1m[36mOrderedProduct Create (0.1ms)[0m  [1m[32mINSERT INTO "ordered_products" ("order_id", "product_id", "baught_price", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["order_id", 3], ["product_id", 1], ["baught_price", 60], ["created_at", "2023-11-10 10:15:11.813332"], ["updated_at", "2023-11-10 10:15:11.813332"]]
  â†³ app/models/product.rb:9:in `to_ordered_product!'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/models/product.rb:9:in `to_ordered_product!'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/models/product.rb:9:in `to_ordered_product!'
  [1m[36mOrder Load (0.7ms)[0m  [1m[34mSELECT "orders".* FROM "orders" WHERE "orders"."id" = ? LIMIT ?[0m  [["id", 3], ["LIMIT", 1]]
  â†³ app/models/product.rb:9:in `to_ordered_product!'
  [1m[36mProduct Load (0.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/models/product.rb:9:in `to_ordered_product!'
  [1m[36mOrderedProduct Create (0.1ms)[0m  [1m[32mINSERT INTO "ordered_products" ("order_id", "product_id", "baught_price", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["order_id", 3], ["product_id", 2], ["baught_price", 120], ["created_at", "2023-11-10 10:15:11.817108"], ["updated_at", "2023-11-10 10:15:11.817108"]]
  â†³ app/models/product.rb:9:in `to_ordered_product!'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/models/product.rb:9:in `to_ordered_product!'
  [1m[36mProduct Load (0.1ms)[0m  [1m[34mSELECT "products".* FROM "products" INNER JOIN "basket_products" ON "products"."id" = "basket_products"."product_id" WHERE "basket_products"."user_id" = ? /* loading for inspect */ LIMIT ?[0m  [["user_id", 1], ["LIMIT", 11]]
  â†³ app/controllers/orders_controller.rb:27:in `to_str'
Completed 500 Internal Server Error in 54ms (Views: 0.1ms | ActiveRecord: 10.2ms | Allocations: 30294)


Started POST "/users/1/orders" for ::1 at 2023-11-10 11:15:22 +0100
Processing by OrdersController#create as */*
  Parameters: {"user_id"=>"1"}
DEPRECATION WARNING: `Rails.application.secrets` is deprecated in favor of `Rails.application.credentials` and will be removed in Rails 7.2. (called from <class:JwtService> at /home/topper/rails_test/products_api/app/services/jwt_service.rb:2)
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:22:in `from_jwt'
  [1m[36mProduct Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "products" INNER JOIN "basket_products" ON "products"."id" = "basket_products"."product_id" WHERE "basket_products"."user_id" = ? LIMIT ?[0m  [["user_id", 1], ["LIMIT", 1]]
  â†³ app/controllers/orders_controller.rb:18:in `create'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/orders_controller.rb:22:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/controllers/orders_controller.rb:22:in `create'
  [1m[36mOrder Create (0.7ms)[0m  [1m[32mINSERT INTO "orders" ("user_id", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["user_id", 1], ["created_at", "2023-11-10 10:15:22.098323"], ["updated_at", "2023-11-10 10:15:22.098323"]]
  â†³ app/controllers/orders_controller.rb:22:in `create'
  [1m[36mTRANSACTION (5.3ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/controllers/orders_controller.rb:22:in `create'
  [1m[36mProduct Load (0.1ms)[0m  [1m[34mSELECT "products".* FROM "products" INNER JOIN "basket_products" ON "products"."id" = "basket_products"."product_id" WHERE "basket_products"."user_id" = ?[0m  [["user_id", 1]]
  â†³ app/controllers/orders_controller.rb:23:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/models/product.rb:9:in `to_ordered_product!'
  [1m[36mOrder Load (0.7ms)[0m  [1m[34mSELECT "orders".* FROM "orders" WHERE "orders"."id" = ? LIMIT ?[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/models/product.rb:9:in `to_ordered_product!'
  [1m[36mProduct Load (0.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/product.rb:9:in `to_ordered_product!'
  [1m[36mOrderedProduct Create (0.1ms)[0m  [1m[32mINSERT INTO "ordered_products" ("order_id", "product_id", "baught_price", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["order_id", 4], ["product_id", 1], ["baught_price", 60], ["created_at", "2023-11-10 10:15:22.122350"], ["updated_at", "2023-11-10 10:15:22.122350"]]
  â†³ app/models/product.rb:9:in `to_ordered_product!'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/models/product.rb:9:in `to_ordered_product!'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/models/product.rb:9:in `to_ordered_product!'
  [1m[36mOrder Load (0.6ms)[0m  [1m[34mSELECT "orders".* FROM "orders" WHERE "orders"."id" = ? LIMIT ?[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/models/product.rb:9:in `to_ordered_product!'
  [1m[36mProduct Load (0.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/models/product.rb:9:in `to_ordered_product!'
  [1m[36mOrderedProduct Create (0.1ms)[0m  [1m[32mINSERT INTO "ordered_products" ("order_id", "product_id", "baught_price", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["order_id", 4], ["product_id", 2], ["baught_price", 120], ["created_at", "2023-11-10 10:15:22.126575"], ["updated_at", "2023-11-10 10:15:22.126575"]]
  â†³ app/models/product.rb:9:in `to_ordered_product!'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/models/product.rb:9:in `to_ordered_product!'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/controllers/orders_controller.rb:24:in `create'
  [1m[36mBasketProduct Load (0.1ms)[0m  [1m[34mSELECT "basket_products".* FROM "basket_products" WHERE "basket_products"."user_id" = ? AND "basket_products"."product_id" IN (?, ?)[0m  [["user_id", 1], ["product_id", 1], ["product_id", 2]]
  â†³ app/controllers/orders_controller.rb:24:in `create'
  [1m[36mBasketProduct Destroy (0.1ms)[0m  [1m[31mDELETE FROM "basket_products" WHERE "basket_products"."id" = ?[0m  [["id", 1]]
  â†³ app/controllers/orders_controller.rb:24:in `create'
  [1m[36mBasketProduct Destroy (0.1ms)[0m  [1m[31mDELETE FROM "basket_products" WHERE "basket_products"."id" = ?[0m  [["id", 2]]
  â†³ app/controllers/orders_controller.rb:24:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/controllers/orders_controller.rb:24:in `create'
Completed 200 OK in 61ms (Views: 0.2ms | ActiveRecord: 11.1ms | Allocations: 35029)


Started GET "/users/1/orders/4" for ::1 at 2023-11-10 11:15:31 +0100
Processing by OrdersController#show as */*
  Parameters: {"user_id"=>"1", "id"=>"4"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:22:in `from_jwt'
  [1m[36mOrder Load (0.1ms)[0m  [1m[34mSELECT "orders".* FROM "orders" WHERE "orders"."user_id" = ? AND "orders"."id" = ?[0m  [["user_id", 1], ["id", 4]]
  â†³ app/controllers/orders_controller.rb:10:in `show'
  [1m[36mOrderedProduct Load (0.1ms)[0m  [1m[34mSELECT "ordered_products".* FROM "ordered_products" WHERE "ordered_products"."order_id" = ?[0m  [["order_id", 4]]
  â†³ app/controllers/orders_controller.rb:10:in `show'
Completed 200 OK in 4ms (Views: 0.1ms | ActiveRecord: 0.2ms | Allocations: 2511)


Started POST "/users/1/orders" for ::1 at 2023-11-10 11:15:39 +0100
Processing by OrdersController#create as */*
  Parameters: {"user_id"=>"1"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:22:in `from_jwt'
  [1m[36mProduct Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "products" INNER JOIN "basket_products" ON "products"."id" = "basket_products"."product_id" WHERE "basket_products"."user_id" = ? LIMIT ?[0m  [["user_id", 1], ["LIMIT", 1]]
  â†³ app/controllers/orders_controller.rb:18:in `create'
Completed 400 Bad Request in 2ms (Views: 0.1ms | ActiveRecord: 0.1ms | Allocations: 1203)


Started POST "/users/1/orders" for ::1 at 2023-11-10 11:16:11 +0100
  
SyntaxError (/home/topper/rails_test/products_api/app/controllers/orders_controller.rb:18: void value expression
/home/topper/rails_test/products_api/app/controllers/orders_controller.rb:24: syntax error, unexpected `rescue', expecting `end' or dummy end
    rescue StandardError => e
    ^~~~~~
/home/topper/rails_test/products_api/app/controllers/orders_controller.rb:28: syntax error, unexpected end-of-input):
  
app/controllers/orders_controller.rb:18: void value expression
app/controllers/orders_controller.rb:24: syntax error, unexpected `rescue', expecting `end' or dummy end
app/controllers/orders_controller.rb:28: syntax error, unexpected end-of-input
Started POST "/users/1/orders" for ::1 at 2023-11-10 11:16:12 +0100
  
SyntaxError (/home/topper/rails_test/products_api/app/controllers/orders_controller.rb:18: void value expression
/home/topper/rails_test/products_api/app/controllers/orders_controller.rb:24: syntax error, unexpected `rescue', expecting `end' or dummy end
    rescue StandardError => e
    ^~~~~~
/home/topper/rails_test/products_api/app/controllers/orders_controller.rb:28: syntax error, unexpected end-of-input):
  
app/controllers/orders_controller.rb:18: void value expression
app/controllers/orders_controller.rb:24: syntax error, unexpected `rescue', expecting `end' or dummy end
app/controllers/orders_controller.rb:28: syntax error, unexpected end-of-input
Started POST "/users/1/orders" for ::1 at 2023-11-10 11:16:18 +0100
Processing by OrdersController#create as */*
  Parameters: {"user_id"=>"1"}
DEPRECATION WARNING: `Rails.application.secrets` is deprecated in favor of `Rails.application.credentials` and will be removed in Rails 7.2. (called from <class:JwtService> at /home/topper/rails_test/products_api/app/services/jwt_service.rb:2)
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:22:in `from_jwt'
  [1m[36mProduct Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "products" INNER JOIN "basket_products" ON "products"."id" = "basket_products"."product_id" WHERE "basket_products"."user_id" = ? LIMIT ?[0m  [["user_id", 1], ["LIMIT", 1]]
  â†³ app/controllers/orders_controller.rb:18:in `create'
Completed 400 Bad Request in 17ms (Views: 0.1ms | ActiveRecord: 1.5ms | Allocations: 10035)


Started POST "/users/1/orders" for ::1 at 2023-11-10 11:16:28 +0100
Processing by OrdersController#create as */*
  Parameters: {"user_id"=>"1"}
DEPRECATION WARNING: `Rails.application.secrets` is deprecated in favor of `Rails.application.credentials` and will be removed in Rails 7.2. (called from <class:JwtService> at /home/topper/rails_test/products_api/app/services/jwt_service.rb:2)
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:22:in `from_jwt'
  [1m[36mProduct Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "products" INNER JOIN "basket_products" ON "products"."id" = "basket_products"."product_id" WHERE "basket_products"."user_id" = ? LIMIT ?[0m  [["user_id", 1], ["LIMIT", 1]]
  â†³ app/controllers/orders_controller.rb:18:in `create'
Completed 400 Bad Request in 17ms (Views: 0.1ms | ActiveRecord: 1.6ms | Allocations: 9964)


Started GET "/users/1/orders" for ::1 at 2023-11-10 11:31:16 +0100
Processing by OrdersController#index as */*
  Parameters: {"user_id"=>"1"}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:22:in `from_jwt'
  [1m[36mOrder Load (0.1ms)[0m  [1m[34mSELECT "orders".* FROM "orders" WHERE "orders"."user_id" = ?[0m  [["user_id", 1]]
  â†³ app/controllers/orders_controller.rb:5:in `index'
  [1m[36mOrderedProduct Load (0.1ms)[0m  [1m[34mSELECT "ordered_products".* FROM "ordered_products" WHERE "ordered_products"."order_id" IN (?, ?, ?, ?)[0m  [["order_id", 1], ["order_id", 2], ["order_id", 3], ["order_id", 4]]
  â†³ app/controllers/orders_controller.rb:5:in `index'
Completed 200 OK in 21ms (Views: 0.2ms | ActiveRecord: 1.6ms | Allocations: 11247)


Started GET "/users/1/orders" for ::1 at 2023-11-10 11:33:37 +0100
Processing by OrdersController#index as */*
  Parameters: {"user_id"=>"1"}
DEPRECATION WARNING: `Rails.application.secrets` is deprecated in favor of `Rails.application.credentials` and will be removed in Rails 7.2. (called from <class:JwtService> at /home/topper/rails_test/products_api/app/services/jwt_service.rb:2)
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:22:in `from_jwt'
  [1m[36mOrder Load (0.1ms)[0m  [1m[34mSELECT "orders".* FROM "orders" WHERE "orders"."user_id" = ?[0m  [["user_id", 1]]
  â†³ app/controllers/orders_controller.rb:5:in `index'
  [1m[36mOrderedProduct Load (0.1ms)[0m  [1m[34mSELECT "ordered_products".* FROM "ordered_products" WHERE "ordered_products"."order_id" IN (?, ?, ?, ?)[0m  [["order_id", 1], ["order_id", 2], ["order_id", 3], ["order_id", 4]]
  â†³ app/controllers/orders_controller.rb:5:in `index'
Completed 200 OK in 25ms (Views: 0.2ms | ActiveRecord: 1.7ms | Allocations: 15480)


Started GET "/V1/users/1/orders" for ::1 at 2023-11-10 11:52:52 +0100
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  
ActionController::RoutingError (No route matches [GET] "/V1/users/1/orders"):
  
Started GET "/v1/users/1/orders" for ::1 at 2023-11-10 11:52:58 +0100
Processing by V1::OrdersController#index as */*
  Parameters: {"user_id"=>"1"}
DEPRECATION WARNING: `Rails.application.secrets` is deprecated in favor of `Rails.application.credentials` and will be removed in Rails 7.2. (called from <class:JwtService> at /home/topper/rails_test/products_api/app/services/jwt_service.rb:2)
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/models/user.rb:22:in `from_jwt'
  [1m[36mOrder Load (0.0ms)[0m  [1m[34mSELECT "orders".* FROM "orders" WHERE "orders"."user_id" = ?[0m  [["user_id", 1]]
  â†³ app/controllers/V1/orders_controller.rb:6:in `index'
  [1m[36mOrderedProduct Load (0.1ms)[0m  [1m[34mSELECT "ordered_products".* FROM "ordered_products" WHERE "ordered_products"."order_id" IN (?, ?, ?, ?)[0m  [["order_id", 1], ["order_id", 2], ["order_id", 3], ["order_id", 4]]
  â†³ app/controllers/V1/orders_controller.rb:6:in `index'
Completed 200 OK in 74ms (Views: 0.2ms | ActiveRecord: 1.0ms | Allocations: 38038)


